{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/distance.js","../src/altitude.js","../src/time.js","../src/slope.js","../src/speed.js","../src/acceleration.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","/**\n * Recursive deep merge objects.\n * Alternative to L.Util.setOptions(this, options).\n */\nexport function deepMerge(target, ...sources) {\n\tif (!sources.length) return target;\n\tconst source = sources.shift();\n\tif (isObject(target) && isObject(source)) {\n\t\tfor (const key in source) {\n\t\t\tif (isObject(source[key])) {\n\t\t\t\tif (!target[key]) Object.assign(target, {\n\t\t\t\t\t[key]: {}\n\t\t\t\t});\n\t\t\t\tdeepMerge(target[key], source[key]);\n\t\t\t} else {\n\t\t\t\tObject.assign(target, {\n\t\t\t\t\t[key]: source[key]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\treturn deepMerge(target, ...sources);\n}\n\n/**\n * Wait for document load before execute function.\n */\nexport function deferFunc(f) {\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\n\telse f();\n}\n/**\n * Debounce function to limit events are being fired.\n */\nexport function debounce(func, wait, context, immediate) {\n\tvar timeout;\n\treturn function() {\n\t\tvar args = arguments;\n\t\tclearTimeout(timeout);\n\t\ttimeout  = setTimeout(function() {\n\t\t\ttimeout = null;\n\t\tif (!immediate) func.apply(context, args);\n\t\t}, wait);\n\t\tif (immediate && !timeout) func.apply(context, args);\n\t};\n}\n\nconst SEC  = 1000;\nconst MIN  = SEC * 60;\nconst HOUR = MIN * 60;\nconst DAY  = HOUR * 24;\n\n/**\n * Convert a duration time (millis) to a human readable string (%Dd %H:%M'%S\")\n */\nexport function formatTime(t) {\n\tlet d = Math.floor(t / DAY);\n\tlet h = Math.floor( (t - d * DAY) / HOUR);\n\tlet m = Math.floor( (t - d * DAY - h * HOUR) / MIN);\n\tlet s = Math.round( (t - d * DAY - h * HOUR - m * MIN) / SEC);\n\tif ( s === 60 ) { m++; s = 0; }\n\tif ( m === 60 ) { h++; m = 0; }\n\tif ( h === 24 ) { d++; h = 0; }\n\treturn (d ? d + \"d \" : '') + h.toString().padStart(2, 0) + ':' + m.toString().padStart(2, 0) + \"'\" + s.toString().padStart(2, 0) + '\"';\n}\n\n/**\n * Simple GeoJSON data loader.\n */\nexport function GeoJSONLoader(data, control) {\n\tif (typeof data === \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\tcontrol = control || this;\n\n  let distanceMarkers = (\n\t\t\tcontrol.options.distanceMarkers === true\n\t\t\t\t? { lazy: true }\n\t\t\t\t: L.extend({ lazy: true }, control.options.distanceMarkers)\n\t);\n\n\tlet layer = L.geoJson(data, {\n\t\tdistanceMarkers: distanceMarkers,\n\t\tstyle: (feature) => {\n\t\t\tlet style = L.extend({}, control.options.polyline);\n\t\t\tif (control.options.theme) {\n\t\t\t\tstyle.className += ' ' + control.options.theme;\n\t\t\t}\n\t\t\treturn style;\n\t\t},\n\t\tpointToLayer: (feature, latlng) => {\n\t\t\tlet marker = L.marker(latlng, { icon: control.options.gpxOptions.marker_options.wptIcons[''] });\n\t\t\tlet prop   = feature.properties;\n\t\t\tlet desc   = prop.desc ? prop.desc : '';\n\t\t\tlet name   = prop.name ? prop.name : '';\n\t\t\tif (name || desc) {\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\n\t\t\t}\n\t\t\tcontrol._registerCheckPoint({latlng:latlng, label: name}, true);\n\t\t\tcontrol.fire('waypoint_added', { point: marker, point_type: 'waypoint', element: latlng });\n\t\t\treturn marker;\n\t\t},\n\t\tonEachFeature: (feature, layer) => {\n\t\t\tif (feature.geometry && feature.geometry.type == 'Point') return;\n\n\t\t\t// Standard GeoJSON\n\t\t\t// control.addData(feature, layer);  // NB uses \"_addGeoJSONData\"\n\n\t\t\t// Extended GeoJSON\n\t\t\tlayer._latlngs.forEach((point, i, data) => {\n\t\t\t\t// same properties as L.GPX layer\n\t\t\t\tpoint.meta = { time: null, ele: null, hr: null, cad: null, atemp: null };\n\t\t\t\tif(\"alt\" in point) point.meta.ele = point.alt;\n\t\t\t\tif(feature.properties) {\n\t\t\t\t\tlet prop = feature.properties;\n\t\t\t\t\tif(\"coordTimes\" in prop) point.meta.time = new Date(Date.parse(prop.coordTimes[i]));\n\t\t\t\t\telse if(\"times\" in prop) point.meta.time = new Date(Date.parse(prop.times[i]));\n\t\t\t\t\telse if(\"time\" in prop) point.meta.time = new Date(Date.parse((typeof prop.time === 'object' ? prop.time[i] : prop.time)));\n\t\t\t\t\tif(\"heartRates\" in prop) point.meta.hr = parseInt(prop.heartRates[i]);\n\t\t\t\t\telse if(\"heartRate\" in prop) point.meta.hr = parseInt((typeof prop.heartRate === 'object' ? prop.heartRate[i] : prop.heartRate));\n\t\t\t\t\t// TODO: cadence, temperature\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontrol.addData(layer); // NB uses \"_addGPXData\"\n\n\t\t\t// Postpone adding the distance markers (lazy: true)\n\t\t\tif(control.options.distanceMarkers && distanceMarkers.lazy) {\n        layer.on('add remove', (e) => {\n          let path = e.target;\n          if (L.DistanceMarkers && path instanceof L.Polyline) {\n            path[e.type + 'DistanceMarkers']();\n          }\n        });\n      }\n\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\n\t\t},\n\t});\n\n\tL.Control.Elevation._d3LazyLoader.then(() => {\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info })\n\t});\n\n\treturn layer;\n}\n\n/**\n * Check DOM element visibility.\n */\nexport function isDomVisible(elem) {\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\n}\n\n/**\n * Check object type.\n */\nexport function isObject(item) {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * Check DOM element viewport visibility.\n */\nexport function isVisible(elem) {\n\tif (!elem) return false;\n\n\tlet styles = window.getComputedStyle(elem);\n\n\tfunction isVisibleByStyles(elem, styles) {\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\n\t}\n\n\tfunction isAboveOtherElements(elem, styles) {\n\t\tlet boundingRect = elem.getBoundingClientRect();\n\t\tlet left = boundingRect.left + 1;\n\t\tlet right = boundingRect.right - 1;\n\t\tlet top = boundingRect.top + 1;\n\t\tlet bottom = boundingRect.bottom - 1;\n\t\tlet above = true;\n\n\t\tlet pointerEvents = elem.style.pointerEvents;\n\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\n\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\n\n\t\t// Only for completely visible elements\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\n\n\t\telem.style.pointerEvents = pointerEvents;\n\n\t\treturn above;\n\t}\n\n\tif (!isVisibleByStyles(elem, styles)) return false;\n\tif (!isAboveOtherElements(elem, styles)) return false;\n\treturn true;\n}\n\n/**\n * Check JSON object type.\n */\nexport function isJSONDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\n\t} else {\n\t\ttry {\n\t\t\tJSON.parse(doc.toString());\n\t\t} catch (e) {\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\n\t\t\tconsole.warn(e);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n/**\n * Check XML object type.\n */\nexport function isXMLDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"<\") == 0;\n\t} else {\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n\t}\n}\n\n/**\n * Async JS script download.\n */\nexport function lazyLoader(url, skip, loader) {\n\tif (skip === false) {\n\t\treturn Promise.resolve();\n\t}\n\tif (loader instanceof Promise) {\n\t\treturn loader;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet tag = document.createElement(\"script\");\n\t\ttag.addEventListener('load', resolve, { once: true });\n\t\ttag.src = url;\n\t\tdocument.head.appendChild(tag);\n\t});\n}\n\n/**\n * Generate download data event.\n */\nexport function saveFile(dataURI, fileName) {\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\n\tlet b = document.body;\n\tb.appendChild(a);\n\ta.click();\n\tb.removeChild(a);\n}\n\n/**\n * Wait for element visible before execute function.\n */\nexport function waitHolder(elem) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet ticking = false;\n\t\tlet scrollFn = () => {\n\t\t\tif (!ticking) {\n\t\t\t\tL.Util.requestAnimFrame(() => {\n\t\t\t\t\tif (isVisible(elem)) {\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t\tticking = false;\n\t\t\t\t});\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('scroll', scrollFn);\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\n\t\tscrollFn();\n\t});\n}\n\n/**\n * A little bit safier than L.DomUtil.addClass\n */\nexport function addClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.addClass(targetNode, s));\n}\n\n/**\n * A little bit safier than L.DomUtil.removeClass()\n */\nexport function removeClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.removeClass(targetNode, s));\n}\n\nexport function toggleClass(targetNode, className, conditional) {\n\treturn (conditional ? addClass : removeClass).call(null, targetNode, className)\n}\n\nexport function replaceClass(targetNode, removeClassName, addClassName) {\n  if (removeClassName) removeClass(targetNode, removeClassName);\n  if (addClassName) addClass(targetNode, addClassName);\n}\n\nexport function style(targetNode, name, value) {\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\n\telse return targetNode.style.setProperty(name, value);\n}\n\nexport function toggleStyle(targetNode, name, value, conditional) {\n  return style(targetNode, name, conditional ? value : '');\n}\n\nexport function toggleEvent(leafletElement, eventName, handler, conditional) {\n\treturn leafletElement[conditional ? 'on' : 'off'](eventName, handler);\n}\n\n/**\n * A little bit shorter than L.DomUtil.create()\n */\nexport function create(tagName, className, attributes, parent) {\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\n\tif (attributes) setAttributes(elem, attributes);\n\tif (parent) append(parent, elem);\n\treturn elem;\n}\n\n/**\n * Same as node.appendChild()\n */\nexport function append(parent, child) {\n\treturn parent.appendChild(child);\n}\n\n/**\n * Same as node.insertAdjacentElement()\n */\nexport function insert(parent, child, position) {\n\treturn parent.insertAdjacentElement(position, child);\n}\n\n/**\n * Loop for node.setAttribute()\n */\nexport function setAttributes(elem, attrs) {\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\n}\n\n/**\n * Same as node.querySelector().\n */\nexport function select(selector, context) {\n\treturn (context || document).querySelector(selector);\n}\n\n/**\n * Alias for L.DomEvent.on.\n */\nexport const on = L.DomEvent.on;\n\n/**\n * Alias for L.DomEvent.off.\n */\nexport const off = L.DomEvent.off;\n\n/**\n * Alias for L.DomUtil.hasClass.\n */\nexport const hasClass = L.DomUtil.hasClass;\n\n\nexport function randomId() {\n\treturn Math.random().toString(36).substr(2, 9);\n}\n\nexport function each(obj, fn) {\n\tfor (let i in obj) fn(obj[i], i);\n}\n","export const Colors = {\n\t'lightblue': { area: '#3366CC', alpha: 0.45, stroke: '#3366CC' },\n\t'magenta'  : { area: '#FF005E' },\n\t'yellow'   : { area: '#FF0' },\n\t'purple'   : { area: '#732C7B' },\n\t'steelblue': { area: '#4682B4' },\n\t'red'      : { area: '#F00' },\n\t'lime'     : { area: '#9CC222', line: '#566B13' }\n};\n\nexport const Area = ({\n\twidth,\n\theight,\n\txAttr,\n\tyAttr,\n\tscaleX,\n\tscaleY,\n\tinterpolation = \"curveLinear\"\n}) => {\n\treturn d3.area()\n\t\t.curve(typeof interpolation === 'string' ? d3[interpolation] : interpolation)\n\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\n\t\t.y0(height)\n\t\t.y1(d => scaleY(d[yAttr]));\n};\n\nexport const Path = ({\n\tname,\n\tcolor,\n\tstrokeColor,\n\tstrokeOpacity,\n\tfillOpacity,\n}) => {\n\tlet path = d3.create('svg:path')\n\n\tif (name) path.classed(name, true);\n\n\tpath.style(\"pointer-events\", \"none\");\n\n\tpath\n\t.attr(\"fill\", color || '#3366CC')\n\t.attr(\"stroke\", strokeColor || '#000')\n\t.attr(\"stroke-opacity\", strokeOpacity || '1')\n\t.attr(\"fill-opacity\", fillOpacity || '0.8');\n\n\treturn path;\n};\n\nexport const Axis = ({\n\ttype = \"axis\",\n\ttickSize = 6,\n\ttickPadding = 3,\n\tposition,\n\theight,\n\twidth,\n\taxis,\n\tscale,\n\tticks,\n\ttickFormat,\n\tlabel,\n\tlabelX,\n\tlabelY,\n\tname = \"\",\n\tonAxisMount,\n}) => {\n\treturn g => {\n\t\tlet [w, h] = [0, 0];\n\t\tif (position == \"bottom\") h = height;\n\t\tif (position == \"right\")  w = width;\n\n\t\tif (axis == \"x\" && type == \"grid\") {\n\t\t\ttickSize = -height;\n\t\t} else if (axis == \"y\" && type == \"grid\") {\n\t\t\ttickSize = -width;\n\t\t}\n\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\n\t\t\t.scale(scale)\n\t\t\t.ticks(ticks)\n\t\t\t.tickPadding(tickPadding)\n\t\t\t.tickSize(tickSize)\n\t\t\t.tickFormat(tickFormat);\n\n\t\tlet axisGroup = g.append(\"g\")\n\t\t\t.attr(\"class\", [axis, type, position, name].join(\" \"))\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\n\t\t\t.call(axisScale);\n\n\t\tif (label) {\n\t\t\taxisGroup.append(\"svg:text\")\n\t\t\t\t.attr(\"x\", labelX)\n\t\t\t\t.attr(\"y\", labelY)\n\t\t\t\t.text(label);\n\t\t}\n\n\t\tif (onAxisMount) {\n\t\t\taxisGroup.call(onAxisMount);\n\t\t}\n\n\t\treturn axisGroup;\n\t};\n};\n\nexport const Grid = (props) => {\n\tprops.type = \"grid\";\n\treturn Axis(props);\n};\n\nexport const HeightFocusLine = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlength = 0,\n}) => {\n\treturn line => line\n\t\t.attr(\"class\", theme + \" height-focus line\")\n\t\t.attr(\"x1\", xCoord)\n\t\t.attr(\"x2\", xCoord)\n\t\t.attr(\"y1\", yCoord)\n\t\t.attr(\"y2\", length);\n};\n\nexport const HeightFocusLabel = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlabel,\n}) => {\n\treturn text => {\n\t\ttext\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\n\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t.attr(\"x\", xCoord + 5)\n\t\t\t.attr(\"y\", yCoord);\n\n\t\tlet y = text.select(\".height-focus-y\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\n\t\ty\n\t\t\t.attr(\"class\", \"height-focus-y\")\n\t\t\t.text(label);\n\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\n\n\t\treturn text;\n\t};\n};\n\nexport const HeightFocusMarker = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n}) => {\n\treturn circle => circle\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\n\t\t.attr(\"r\", 6)\n\t\t.attr(\"cx\", 0)\n\t\t.attr(\"cy\", 0);\n};\n\nexport const LegendItem = ({\n\tname,\n  label,\n\twidth,\n\theight,\n\tmargins = {},\n\tcolor,\n\tpath\n}) => {\n\treturn g => {\n\t\tg\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\n\t\t\t.attr(\"data-name\", name);\n\n\t\tconst svg = d3.select(g.node().ownerSVGElement || g);\n\n\t\tg.on('click.legend', () => svg.dispatch(\"legend_clicked\", {\n\t\t\tdetail: {\n\t\t\t\tpath: path.node(),\n\t\t\t\tname: name,\n\t\t\t\tlegend: g.node(),\n\t\t\t\tenabled: !path.classed('leaflet-hidden'),\n\t\t\t}\n\t\t}));\n\n\t\tg.append(\"svg:rect\")\n\t\t\t.attr(\"x\", (width / 2) - 50)\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\n\t\t\t.attr(\"width\", 50)\n\t\t\t.attr(\"height\", 10)\n\t\t\t.attr(\"fill\", color)\n\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\n\t\tg.append('svg:text')\n\t\t\t.text(L._(label || name))\n\t\t\t.attr(\"x\", (width / 2) + 5)\n\t\t\t.attr(\"font-size\", 10)\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr('y', height + margins.bottom / 2)\n\t\t\t.attr('dy', \"0.75em\");\n\n\t\treturn g;\n\t}\n};\n\nexport const MouseFocusLine = ({\n\txCoord = 0,\n\theight,\n}) => {\n\treturn line => line\n\t\t.attr('class', 'mouse-focus-line')\n\t\t.attr('x2', xCoord)\n\t\t.attr('y2', 0)\n\t\t.attr('x1', xCoord)\n\t\t.attr('y1', height);\n};\n\nexport const MouseFocusLabel = ({\n\txCoord,\n\tyCoord,\n\tlabelX = \"\",\n\tlabelY = \"\",\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.attr('class', 'mouse-focus-label');\n\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\n\t\tlet text = g.select(\".mouse-focus-label-text\");\n\t\tlet y    = text.select(\".mouse-focus-label-y\");\n\t\tlet x    = text.select(\".mouse-focus-label-x\");\n\n\t\tif (!rect.node()) rect = g.append(\"svg:rect\");\n\t\tif (!text.node()) text = g.append(\"svg:text\");\n\t\tif (!y.node())    y    = text.append(\"svg:tspan\");\n\t\tif (!x.node())    x    = text.append(\"svg:tspan\");\n\n\t\ty.text(labelY);\n\t\tx.text(labelX);\n\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\n\t\tlet xAlign = 0;\n\t\tlet yAlign = 0;\n\t\tlet bbox   = { width: 0, height: 0 };\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\n\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\n\n\t\trect\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\n\t\t\t.attr(\"x\", xAlign - 5)\n\t\t\t.attr(\"y\", yAlign - 5)\n\t\t\t.attr(\"width\", bbox.width + 10)\n\t\t\t.attr(\"height\", bbox.height + 10)\n\t\t\t.attr(\"rx\", 3)\n\t\t\t.attr(\"ry\", 3);\n\t\ttext\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr(\"y\", yAlign);\n\t\ty\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\n\t\t\t.attr(\"dy\", \"1em\");\n\t\tx\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\n\t\t\t.attr(\"dy\", \"2em\");\n\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\n\n\t\treturn g;\n\t};\n};\n\nexport const Ruler = ({\n\theight,\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.data([{\n\t\t\t\t\"x\": 0,\n\t\t\t\t\"y\": height,\n\t\t\t}])\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tlet rect   = g.selectAll('.horizontal-drag-rect')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet line   = g.selectAll('.horizontal-drag-line')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet label  = g.selectAll('.horizontal-drag-label')\n\t\t\t.data([{ w: width - 8 }]);\n\n\t\tlet symbol = g.selectAll('.horizontal-drag-symbol')\n\t\t\t.data([{\n\t\t\t\t\"type\": d3.symbolTriangle,\n\t\t\t\t\"x\": width + 7,\n\t\t\t\t\"y\": 0,\n\t\t\t\t\"angle\": -90,\n\t\t\t\t\"size\": 50\n\t\t\t}]);\n\n\t\trect.exit().remove();\n\t\tline.exit().remove();\n\t\tlabel.exit().remove();\n\t\tsymbol.exit().remove();\n\n\t\trect.enter()\n\t\t\t.append(\"svg:rect\")\n\t\t\t.attr(\"class\", \"horizontal-drag-rect\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", -8)\n\t\t\t.attr(\"height\", 8)\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('pointer-events', 'all')\n\t\t\t.merge(rect)\n\t\t\t.attr(\"width\", d => d.w);\n\n\t\tline.enter()\n\t\t\t.append(\"svg:line\")\n\t\t\t.attr(\"class\", \"horizontal-drag-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.merge(line)\n\t\t\t.attr(\"x2\", d => d.w);\n\n\t\tlabel.enter()\n\t\t\t.append(\"svg:text\")\n\t\t\t.attr(\"class\", \"horizontal-drag-label\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"y\", -8)\n\t\t\t.merge(label)\n\t\t\t.attr(\"x\", d => d.w)\n\n\t\tsymbol\n\t\t\t.enter()\n\t\t\t.append(\"svg:path\")\n\t\t\t.attr(\"class\", \"horizontal-drag-symbol\")\n\t\t\t.merge(symbol)\n\t\t\t.attr(\"d\",\n\t\t\t\td3.symbol()\n\t\t\t\t.type(d => d.type)\n\t\t\t\t.size(d => d.size)\n\t\t\t)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \") rotate(\" + d.angle + \")\");\n\n\t\treturn g;\n\t}\n};\n\nexport const Domain = ({\n\tmin,\n\tmax,\n\tattr,\n\tname,\n\tforceBounds\n}) => function(data) {\n\tattr = attr || name;\n\tlet domain = data && data.length ? d3.extent(data, d => d[attr]) : [0, 1];\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\n\t\tdomain[0] = min;\n\t}\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\n\t\tdomain[1] = max;\n\t}\n\treturn domain;\n};\n\nexport const Range = ({\n\taxis\n}) => function(width, height) {\n\tif (axis == 'x')      return [0, width];\n\telse if (axis == 'y') return [height, 0];\n};\n\nexport const Scale = ({\n\tdata,\n\tattr,\n\tmin,\n\tmax,\n\tforceBounds,\n\trange,\n}) => {\n\treturn d3.scaleLinear()\n\t\t.range(range)\n\t\t.domain(Domain({min, max, attr, forceBounds})(data));\n};\n\nexport const Bisect = ({\n\tdata = [0, 1],\n\tscale,\n\tx,\n\tattr\n}) => {\n\treturn d3\n\t\t.bisector(d => d[attr])\n\t\t.left(data, scale.invert(x));\n};\n\nexport const Chart = ({\n\twidth,\n\theight,\n\tmargins = {},\n\truler,\n}) => {\n\n\tconst _width   = width - margins.left - margins.right;\n\tconst _height  = height - margins.top - margins.bottom;\n\n\t// SVG Container\n\tconst svg   = d3.create(\"svg:svg\").attr(\"class\", \"background\");\n\n\t// SVG Groups\n\tconst g     = svg.append(\"g\");\n\tconst panes = {\n\t\tgrid   : g.append(\"g\").attr(\"class\", \"grid\"),\n\t\tarea   : g.append('g').attr(\"class\", \"area\"),\n\t\tpoint  : g.append('g').attr(\"class\", \"point\"),\n\t\taxis   : g.append('g').attr(\"class\", \"axis\"),\n\t\tbrush  : g.append(\"g\").attr(\"class\", \"brush\"),\n\t\ttooltip: g.append(\"g\").attr(\"class\", \"tooltip\").attr('display', 'none'),\n\t\truler  : g.append('g').attr('class', 'ruler'),\n\t\tlegend : g.append('g').attr(\"class\", \"legend\"),\n\t};\n\n\t// SVG Paths\n\tconst clipPath      = panes.area.append(\"svg:clipPath\").attr(\"id\", 'elevation-clipper');\n\tconst clipRect      = clipPath.append(\"svg:rect\");\n\n\t// Canvas Paths\n\tconst foreignObject = panes.area.append('svg:foreignObject');\n\tconst canvas        = foreignObject.append('xhtml:canvas').attr('class', 'canvas-plot');\n\tconst context       = canvas.node().getContext('2d');\n\n\t// Mouse Focus\n\tconst dragG         = panes.ruler;\n\tconst focusG        = panes.tooltip;\n\tconst brushG        = panes.brush;\n\n\tfocusG.append('svg:line')\n\t\t.call(\n\t\t\tMouseFocusLine({\n\t\t\t\txCoord: 0,\n\t\t\t\theight: _height\n\t\t\t})\n\t\t);\n\n\tfocusG.append(\"g\")\n\t\t.call(\n\t\t\tMouseFocusLabel({\n\t\t\t\txCoord: 0,\n\t\t\t\tyCoord: 0,\n\t\t\t\theight: _height,\n\t\t\t\twidth : _width,\n\t\t\t\tlabelX: \"\",\n\t\t\t\tlabelY: \"\",\n\t\t\t})\n\t\t);\n\n\n\t// Add the brushing\n\tlet brush           = d3.brushX().on('start.cursor end.cursor brush.cursor', () => brushG.select(\".overlay\").attr('cursor', null));\n\n\t// Scales\n\tconst scale         = (opts) => ({ x: Scale(opts.x), y: Scale(opts.y)});\n\n\tlet utils = {\n\t\tclipPath,\n\t\tcanvas,\n\t\tcontext,\n\t\tdragG,\n\t\tfocusG,\n\t\tbrush,\n\t};\n\n\tlet chart = {\n\t\tsvg,\n\t\tg,\n\t\tpanes,\n\t\tutils,\n\t\tscale,\n\t};\n\n\t// Resize\n\tchart._resize  = ({\n\t\twidth,\n\t\theight,\n\t\tmargins = {},\n\t\truler,\n\t}) => {\n\n\t\tconst _width   = width - margins.left - margins.right;\n\t\tconst _height  = height - margins.top - margins.bottom;\n\n\t\tsvg.attr(\"viewBox\", `0 0 ${width} ${height}`)\n\t\t\t.attr(\"width\", width)\n\t\t\t.attr(\"height\", height);\n\n\t\tg.attr(\"transform\", \"translate(\" + margins.left + \",\" + margins.top + \")\");\n\n\t\tclipRect\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", 0)\n\t\t\t.attr(\"width\", _width)\n\t\t\t.attr(\"height\", _height);\n\n\t\tforeignObject\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tcanvas\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tif (ruler) {\n\t\t\tdragG    .call(Ruler({ height: _height, width: _width }));\n\t\t}\n\n\t\tbrushG.call(brush.extent( [ [0,0], [_width, _height] ] ));\n\t\tbrushG.select(\".overlay\").attr('cursor', null);\n\n\t\tchart._width  = _width;\n\t\tchart._height = _height;\n\n\t\tchart.svg.dispatch('resize', { detail: { width: _width, height: _height } } );\n\n\t};\n\n\tchart.pane = (name) => {\n\t\tif (!panes[name]) {\n\t\t\tpanes[name] = g.append('g').attr(\"class\", name);\n\t\t}\n\t\treturn panes[name];\n\t}\n\n\tchart.get = (name) => utils[name];\n\n\tchart._resize({ width, height, margins});\n\n\treturn chart;\n};\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Chart = L.Class.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\tinitialize: function(opts, control) {\n\t\tthis.options       = opts;\n\t\tthis.control       = control;\n\n\t\tthis._data         = [];\n\n\t\t// cache registered components\n\t\tthis._props        = {\n\t\t\tscales     : {},\n\t\t\tpaths      : {},\n\t\t\tareas      : {},\n\t\t\tgrids      : {},\n\t\t\taxes       : {},\n\t\t\tlegendItems: {},\n\t\t\tfocusLabels: {},\n\t\t};\n\n\t\tthis._scales       = {};\n\t\tthis._domains      = {};\n\t\tthis._ranges       = {};\n\t\tthis._paths        = {};\n\n\t\tthis._brushEnabled = opts.dragging;\n\t\tthis._zoomEnabled  = opts.zooming;\n\n\t\tif (opts.imperial) {\n\t\t\tthis._xLabel  = \"mi\";\n\t\t\tthis._yLabel  = \"ft\";\n\t\t} else {\n\t\t\tthis._xLabel  = opts.xLabel;\n\t\t\tthis._yLabel  = opts.yLabel;\n\t\t}\n\n\t\tlet chart       = this._chart = D3.Chart(opts);\n\n\t\t// SVG Container\n\t\tlet svg         = this._container = chart.svg;\n\n\t\t// Panes\n\t\tthis._grid      = chart.pane('grid');\n\t\tthis._area      = chart.pane('area');\n\t\tthis._point     = chart.pane('point');\n\t\tthis._axis      = chart.pane('axis');\n\t\tthis._legend    = chart.pane('legend');\n\n\t\t// Scales\n\t\tthis._initScale();\n\n\t\t// Helpers\n\t\tthis._clipPath  = chart.get('clipPath');\n\t\tthis._canvas    = chart.get('canvas');\n\t\tthis._context   = chart.get('context');\n\t\tthis._dragG     = chart.get('dragG');\n\t\tthis._focusG    = chart.get('focusG');\n\t\tthis._brush     = chart.get('brush');\n\n\t\t// Tooltip\n\t\tthis._focusline  = this._focusG.select('.mouse-focus-line');\n\t\tthis._focuslabel = this._focusG.select('.mouse-focus-label');\n\n\t\tthis._zoom = d3.zoom();\n\t\tthis._drag = d3.drag();\n\n\t\t// Interactions\n\t\tthis._initInteractions();\n\n\t\t// svg.on('resize', (e)=>console.log(e.detail));\n\n\t},\n\n\tupdate: function(props) {\n\t\tif (props) {\n\t\t\tif (props.data) this._data = props.data;\n\t\t\tif (props.options) this.options = props.options;\n\t\t}\n\n\t\tthis._updateScale();\n\t\tthis._updateArea();\n\t\tthis._updateAxis();\n\t\tthis._updateLegend();\n\t\tthis._updateClipper();\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container.node());\n\t},\n\n\tclear: function() {\n\t\tthis._resetDrag();\n\t\tthis._area.selectAll('path').attr(\"d\", \"M0 0\");\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\t\tif (this._path) {\n\t\t\t// this._x.domain([0, 1]);\n\t\t\t// this._y.domain([0, 1]);\n\t\t}\n\t},\n\n\t_drawPath: function(name) {\n\t\tlet opts   = this.options;\n\t\tlet ctx    = this._context;\n\n\t\tlet path   = this._paths[name];\n\t\tlet area   = this._props.areas[name];\n\t\tlet node   = path.node();\n\t\tlet scaleX = this._scales[area.scaleX];\n\t\tlet scaleY = this._scales[area.scaleY];\n\n\t\tarea = L.extend({}, area, {\n\t\t\twidth        : this._width(),\n\t\t\theight       : this._height(),\n\t\t\tscaleX       : scaleX,\n\t\t\tscaleY       : scaleY\n\t\t});\n\n\t\tif (!scaleY || !scaleY) {\n\t\t\treturn console.warn('Unable to render path:' + name);\n\t\t}\n\n\t\tpath.datum(this._data).attr(\"d\", D3.Area(area));\n\n\t\tif (path.classed('leaflet-hidden')) return;\n\n\t\tif (opts.preferCanvas) {\n\t\t\tpath.classed('canvas-path', true);\n\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(0, 0);\n\t\t\tlet p = new Path2D(path.attr('d'));\n\n\t\t\tctx.strokeStyle = path.attr('stroke');\n\t\t\tctx.fillStyle   = path.attr('fill');\n\t\t\tctx.lineWidth   = 1.25;\n\t\t\tctx.globalCompositeOperation = 'source-over';\n\n\t\t\t// stroke opacity\n\t\t\tctx.globalAlpha = path.attr('stroke-opacity') || 0.3;\n\t\t\tctx.stroke(p);\n\n\t\t\t// fill opacity\n\t\t\tctx.globalAlpha = path.attr('fill-opacity')   || 0.45;\n\t\t\tctx.fill(p);\n\n\t\t\tctx.globalAlpha = 1;\n\n\t\t\tctx.closePath();\n\t\t} else {\n\t\t\tthis._area.append(() => node);\n\t\t}\n\t},\n\n\t_hasActiveLayers: function() {\n\t\tconst paths = this._paths;\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Initialize \"d3-brush\".\n\t */\n\t_initBrush: function(e) {\n\t\tconst brush   = (e) => {\n\t\t\tlet extent  = e.selection;\n\t\t\tif (extent) {\n\t\t\t\tlet start = this._findIndexForXCoord(extent[0]);\n\t\t\t\tlet end   = this._findIndexForXCoord(extent[1]);\n\t\t\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\n\t\t\t}\n\t\t}\n\n\t\tconst focus   = (e) => {\n\t\t\tif (e.type == 'brush' && !e.sourceEvent) return;\n\t\t\tlet rect    = this._chart.panes.brush.select('.overlay').node();\n\t\t\tlet coords  = d3.pointers(e, rect)[0];\n\t\t\tlet xCoord  = coords[0];\n\t\t\tlet item    = this._data[this._findIndexForXCoord(xCoord)];\n\n\t\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\n\t\t};\n\n\t\tthis._brush\n\t\t\t.filter((e) => this._brushEnabled && !e.shiftKey && !e.button)\n\t\t\t.on(\"end.update\", brush)\n\t\t\t.on(\"brush.update\", focus);\n\n\t\tthis._chart.panes.brush\n\t\t\t.on(\"mouseenter.focus touchstart.focus\", this.fire.bind(this, \"mouse_enter\"))\n\t\t\t.on(\"mouseout.focus touchend.focus\",     this.fire.bind(this, \"mouse_out\")  )\n\t\t\t.on(\"mousemove.focus touchmove.focus\",   focus                              );\n\n\t},\n\n\t/**\n\t * Initialize \"d3-zoom\"\n\t */\n\t_initClipper: function() {\n\t\tlet svg       = this._container;\n\t\tlet margin    = this.options.margins;\n\n\t\tconst zoom    = this._zoom;\n\n\t\tconst onStart = (e) => {\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousedown\") svg.style('cursor', 'grabbing');\n\t\t\tif (e.transform.k == 1 && e.transform.x == 0) {\n\t\t\t\tthis._container.classed('zoomed', true);\n\t\t\t}\n\t\t\tthis.zooming = true;\n\t\t};\n\n\t\tconst onEnd  = (e) => {\n\t\t\tif (e.transform.k ==1 && e.transform.x == 0){\n\t\t\t\tthis._container.classed('zoomed', false);\n\t\t\t}\n\t\t\tthis.zooming = false;\n\t\t\tsvg.style('cursor', '');\n\t\t};\n\n\t\tconst onZoom = (e) => {\n\t\t\t// TODO: find a faster way to redraw the chart.\n\t\t\tthis.zooming = false;\n\t\t\tthis._updateScale(); // hacky way for restoring x scale when zooming out\n\t\t\tthis.zooming = true;\n\t\t\tthis._scales.distance = this._x = e.transform.rescaleX(this._x); // calculate x scale at zoom level\n\t\t\tthis._resetDrag();\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousemove\") {\n\t\t\t\tthis._hideDiagramIndicator();\n\t\t\t}\n\t\t\tthis.fire('zoom');\n\t\t};\n\n\t\tzoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t])\n\t\t\t.filter((e) => this._zoomEnabled && (e.shiftKey || e.buttons == 4))\n\t\t\t.on(\"start\", onStart)\n\t\t\t.on(\"end\", onEnd)\n\t\t\t.on(\"zoom\", onZoom);\n\n\t\tsvg.call(zoom); // add zoom functionality to \"svg\" group\n\n\t\t// d3.select(\"body\").on(\"keydown.grabzoom keyup.grabzoom\", (e) => svg.style('cursor', e.shiftKey ? 'move' : ''));\n\n\t},\n\n\t_initInteractions: function() {\n\t\tthis._initBrush();\n\t\tthis._initRuler();\n\t\tthis._initClipper();\n\t\tthis._initLegend();\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_initLegend: function() {\n\t\tthis._container.on('legend_clicked', (e) => {\n\t\t\tlet { path, legend, name, enabled } = e.detail;\n\n\t\t\tif (!path) return;\n\n\t\t\tlet label = _.select('text', legend);\n\t\t\tlet rect  = _.select('rect', legend);\n\n\t\t\t_.toggleStyle(label, 'text-decoration-line', 'line-through', enabled);\n\t\t\t_.toggleStyle(rect,  'fill-opacity',         '0',            enabled);\n\t\t\t_.toggleClass(path,  'leaflet-hidden',                       enabled);\n\n\t\t\tthis._updateArea();\n\n\t\t\tthis.fire(\"elepath_toggle\", { path, name, legend, enabled })\n\t\t});\n\t},\n\n\t/**\n\t * Initialize \"ruler\".\n\t */\n\t_initRuler: function() {\n\t\tif (!this.options.ruler) return;\n\n\t\t// const yMax      = this._height();\n\t\tconst formatNum = d3.format(\".0f\");\n\t\tconst drag      = this._drag;\n\n\t\tconst label     = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet y         = this._dragG.data()[0].y;\n\t\t\tif (y >= yMax || y <= 0) this._dragG.select(\".horizontal-drag-label\").text('');\n\t\t\tthis._hideDiagramIndicator();\n\t\t};\n\n\t\tconst position  = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet yCoord    = d3.pointers(e, this._area.node())[0][1];\n\t\t\tlet y         = yCoord > 0 ? (yCoord < yMax ? yCoord : yMax) : 0;\n\t\t\tlet z         = this._y.invert(y);\n\t\t\tlet data      = L.extend(this._dragG.data()[0], { y: y });\n\n\t\t\tthis._dragG\n\t\t\t\t.data([data])\n\t\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\")\n\t\t\t\t.classed('active', y < yMax);\n\n\t\t\tthis._container.select(\".horizontal-drag-label\")\n\t\t\t\t.text(formatNum(z) + \" \" + this._yLabel);\n\n\t\t\tthis.fire('ruler_filter', { coords: yCoord < yMax && yCoord > 0 ? this._findCoordsForY(yCoord) : [] });\n\t\t}\n\n\t\tdrag\n\t\t.on(\"start end\", label)\n\t\t.on(\"drag\", position);\n\n\t\tthis._dragG.call(drag);\n\n\t},\n\n\t/**\n\t * Initialize x and y scales\n\t */\n\t_initScale: function() {\n\t\tlet opts = this.options;\n\n\t\tthis._registerAxisScale({\n\t\t\taxis    : 'x',\n\t\t\tposition: 'bottom',\n\t\t\tattr    : opts.xAttr,\n\t\t\tmin     : opts.xAxisMin,\n\t\t\tmax     : opts.xAxisMax,\n\t\t\tname    : 'distance'\n\t\t});\n\n\t\tthis._registerAxisScale({\n\t\t\taxis     : 'y',\n\t\t\tposition : 'left',\n\t\t\tattr     : opts.yAttr,\n\t\t\tmin      : opts.yAxisMin,\n\t\t\tmax      : opts.yAxisMax,\n\t\t\tname     : 'altitude'\n\t\t});\n\n\t\tthis._x = this._scales.distance;\n\t\tthis._y = this._scales.altitude;\n\t},\n\n\t_registerAreaPath: function(props) {\n\t\tlet opts = this.options;\n\n\t\tif (!props.xAttr) props.xAttr = opts.xAttr;\n\t\tif (!props.yAttr) props.yAttr = opts.yAttr;\n\t\tif (typeof props.preferCanvas === \"undefined\") props.preferCanvas = opts.preferCanvas;\n\n\t\tlet path = D3.Path(props);\n\n\t\t// Save paths in memory for latter usage\n\t\tthis._paths[props.name]       = path;\n\t\tthis._props.areas[props.name] = props;\n\n\t\tif (opts.legend) {\n\t\t\tthis._props.legendItems[props.name] = {\n\t\t\t\tname   : props.name,\n\t\t\t\tlabel  : props.label,\n\t\t\t\tcolor  : props.color,\n\t\t\t\tpath   : path\n\t\t\t};\n\t\t}\n\n\t},\n\n\t_registerAxisGrid: function(props) {\n\t\tthis._props.grids[props.name || props.axis] = props;\n\t},\n\n\t_registerAxisScale: function(props) {\n\t\tlet opts  = this.options;\n\t\tlet scale = props.scale;\n\n\t\tif (typeof scale !== 'function') {\n\t\t\tscale       = L.extend({\n\t\t\t\tdata       : this._data,\n\t\t\t\tforceBounds: opts.forceAxisBounds\n\t\t\t}, scale);\n\n\t\t\tscale.attr   = scale.attr || props.name;\n\n\t\t\tlet domain   = this._domains[props.name] = D3.Domain(props);\n\t\t\tlet range    = this._ranges[props.name]  = D3.Range(props);\n\t\t\tscale.range  = scale.range  || range(this._width(),this._height());\n\t\t\tscale.domain = scale.domain || domain(this._data);\n\n\t\t\tthis._props.scales[props.name] = scale;\n\n\t\t\tprops.scale = this._scales[props.name] = D3.Scale(scale);\n\t\t}\n\n\t\tif (!props.ticks) {\n\t\t\tif (props.axis == 'x')      props.ticks = opts.xTicks;\n\t\t\telse if (props.axis == 'y') props.ticks = opts.yTicks;\n\t\t}\n\n\t\tthis._props.axes[props.name] = props;\n\n\t\treturn scale;\n\t},\n\n\t/**\n\t * Add a waypoint of interest over the chart\n\t */\n\t_registerCheckPoint: function(point) {\n\t\tif (!this._data.length) return;\n\n\t\tlet item, x, y;\n\n\t\tif (point.latlng) {\n\t\t\titem = this._data[this._findIndexForLatLng(point.latlng)];\n\t\t\tx    = this._x(item.dist);\n\t\t\ty    = this._y(item.z);\n\t\t} else if (!isNaN(point.dist)) {\n\t\t\tx    = this._x(point.dist);\n\t\t\titem = this._data[this._findIndexForXCoord(x)]\n\t\t\ty    = this._y(item.z);\n\t\t} else\n\n\t\tif (isNaN(x) || isNaN(y)) return;\n\n\t\tif (!point.item || !point.item.property('isConnected')) {\n\t\t\tpoint.position = point.position || \"bottom\";\n\n\t\t\tpoint.item = this._point.append('g');\n\n\t\t\tpoint.item.append(\"svg:line\")\n\t\t\t\t.attr(\"y1\", 0)\n\t\t\t\t.attr(\"x1\", 0)\n\t\t\t\t.attr(\"style\",\"stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;\");\n\n\t\t\tpoint.item\n\t\t\t\t.append(\"svg:circle\")\n\t\t\t\t.attr(\"class\", \" height-focus circle-lower\")\n\t\t\t\t.attr(\"r\", 3);\n\n\t\t\tif (point.label) {\n\t\t\t\tpoint.item.append(\"svg:text\")\n\t\t\t\t\t.attr(\"dx\", \"4px\")\n\t\t\t\t\t.attr(\"dy\", \"-4px\");\n\t\t\t}\n\t\t}\n\n\t\tpoint.item\n\t\t\t.datum({\n\t\t\t\tpos: point.position,\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t})\n\t\t\t.attr(\"class\", d => \"point \" + d.pos)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tpoint.item.select('line')\n\t\t\t.datum({\n\t\t\t\ty2: ({'top': -y, 'bottom': this._height() - y})[point.position],\n\t\t\t\tx2: ({'left': -x, 'right': this._width() - x})[point.position] || 0\n\t\t\t})\n\t\t\t.attr(\"y2\", d => d.y2)\n\t\t\t.attr(\"x2\", d => d.x2)\n\n\t\tif (point.label) {\n\t\t\tpoint.item.select('text')\n\t\t\t\t.text(point.label);\n\t\t}\n\n\t},\n\n\t_registerFocusLabel: function(props) {\n\t\tthis._props.focusLabels[props.name] = props;\n\t},\n\n\t_updateArea: function() {\n\t\tlet paths = this._paths;\n\t\t// Reset and update chart profiles\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\tthis._drawPath(i);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateAxis: function() {\n\n\t\tlet opts = this.options;\n\n\t\t// Reset chart axis.\n\t\tthis._grid.selectAll('g').remove();\n\t\tthis._axis.selectAll('g').remove();\n\n\t\tlet grids = this._props.grids;\n\t\tlet axes  = this._props.axes;\n\t\tlet props, axis, grid;\n\n\t\tlet gridOpts = {\n\t\t\twidth     : this._width(),\n\t\t\theight    : this._height(),\n\t\t\ttickFormat: \"\",\n\t\t};\n\t\tlet axesOpts  = {\n\t\t\twidth  : this._width(),\n\t\t\theight : this._height(),\n\t\t};\n\n\t\t// Render grids\n\t\tfor (let i in grids) {\n\t\t\tprops = L.extend({}, gridOpts, grids[i]);\n\t\t\tgrid  = D3.Grid(props);\n\t\t\tthis._grid.call(grid);\n\t\t}\n\n\t\t// Render axis\n\t\tfor (let i in axes) {\n\t\t\tif (opts[i] === false || opts[i] === 'summary') continue;\n\t\t\tprops = L.extend({}, axesOpts, axes[i]);\n\t\t\taxis  = D3.Axis(props);\n\t\t\tthis._axis.call(axis);\n\t\t}\n\n\t\t// Adjust axis scale positions\n\t\tthis._axis\n\t\t\t.selectAll('.y.axis.right')\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet axis      = d3.select(n[i]);\n\t\t\t\tlet transform = axis.attr('transform');\n\t\t\t\tlet translate = transform.substring(transform.indexOf(\"(\") + 1, transform.indexOf(\")\")).split(\",\");\n\n\t\t\t\taxis.attr('transform', 'translate(' + (+translate[0] + (i * 40)) + ',' + translate[1] + ')')\n\n\t\t\t\tif (i > 0) {\n\t\t\t\t\taxis.select(':scope > path')         .attr('opacity', 0.25);\n\t\t\t\t\taxis.selectAll(':scope > .tick line').attr('opacity', 0.75);\n\t\t\t\t}\n\n\t\t\t});\n\n\t},\n\n\t_updateClipper: function() {\n\t\tlet margin = this.options.margins;\n\n\t\tthis._zoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t]);\n\n\t},\n\n\t_updateLegend: function () {\n\t\tlet legends = this._props.legendItems;\n\t\tlet legend;\n\n\t\t// Reset legend items\n\t\tthis._legend.selectAll('g').remove();\n\t\tfor (var i in legends) {\n\t\t\tlegend = D3.LegendItem(\n\t\t\t\tL.extend({\n\t\t\t\t\twidth  : this._width(),\n\t\t\t\t\theight : this._height(),\n\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t}, legends[i])\n\t\t\t)\n\t\t\tthis._legend.append(\"g\").call(legend);\n\t\t}\n\n\t\t// Get legend items\n\t\tlet items  = this._legend.selectAll('.legend-item');\n\n\t\t// Calculate legend item positions\n\t\tlet n    = items.nodes().length;\n\t\tlet v      = Array(Math.floor(n / 2)).fill(null).map((d, i) => (i + 1) * 2 - (1 - Math.sign(n % 2)));\n\t\tlet rev    = v.slice().reverse().map((d) => -(d));\n\n\t\tif (n % 2 !== 0) {\n\t\t\trev.push(0);\n\t\t}\n\t\tv = rev.concat(v);\n\n\t\t// Get chart margins\n\t\tlet xAxesB  = this._axis.selectAll('.x.axis.bottom').nodes().length;\n\t\tlet marginB = 60 + (xAxesB * 2);\n\t\tlet marginR = n * 30;\n\n\t\t// Adjust chart right margins\n\t\tif (n && this.options.margins.right != marginR) {\n\t\t\tthis.options.margins.right  = marginR;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\t// Adjust chart bottom margins\n\t\tif(xAxesB && this.options.margins.bottom != marginB) {\n\t\t\tthis.options.margins.bottom = marginB;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\titems\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet legend  = d3.select(n[i]);\n\t\t\t\tlet rect    = legend.select('rect');\n\t\t\t\tlet name    = legend.attr('data-name');\n\t\t\t\tlet path    = this._paths[name];\n\n\t\t\t\tlet tx      = v[i] * 55;\n\t\t\t\tlet ty      = xAxesB * 2;\n\n\t\t\t\tlegend\n\n\t\t\t\t// Adjust legend item positions\n\t\t\t\t.attr(\"transform\", \"translate(\" + tx + \", \" + ty + \")\");\n\n\t\t\t\t// Set initial state (disabled controls)\n\t\t\t\tif (name in this.options && this.options[name] == 'disabled') {\n\t\t\t\t\tpath.classed('leaflet-hidden', true);\n\t\t\t\t\tlegend.select('text').style('text-decoration-line', 'line-through');\n\t\t\t\t\tlegend.select('rect').style('fill-opacity', '0');\n\t\t\t\t}\n\n\t\t\t\t// Apply d3-zoom (bind <clipPath> mask)\n\t\t\t\tif (this._clipPath) {\n\t\t\t\t\tpath.attr('clip-path', 'url(#' + this._clipPath.attr('id') + ')');\n\t\t\t\t}\n\n\t\t\t});\n\t},\n\n\t_updateScale: function() {\n\t\tif (this.zooming) return { x: this._x, y: this._y };\n\n\t\tlet opts = this.options;\n\n\t\tlet scales  = this._scales;\n\t\tlet d = this._domains;\n\t\tlet r = this._ranges;\n\n\t\tfor (let i in scales) {\n\t\t\tscales[i]\n\t\t\t.domain(d[i](this._data))\n\t\t\t.range(r[i](this._width(), this._height()))\n\t\t}\n\n\t\treturn { x: this._x, y: this._y };\n\t},\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\treturn this._chart._width;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\treturn this._chart._height;\n\t},\n\n\t/*\n\t * Finds data entries above a given y-elevation value and returns geo-coordinates\n\t */\n\t_findCoordsForY: function(y) {\n\t\tlet data = this._data;\n\t\tlet z    = this._y.invert(y);\n\n\t\t// save indexes of elevation values above the horizontal line\n\t\tconst list = data.reduce((array, item, index) => {\n\t\t\tif (item.z >= z) array.push(index);\n\t\t\treturn array;\n\t\t}, []);\n\n\t\tlet start = 0;\n\t\tlet next;\n\n\t\t// split index list into blocks of coordinates\n\t\tconst coords = list.reduce((array, _, curr) => {\n\t\t\tnext = curr + 1;\n\t\t\tif (list[next] !== list[curr] + 1 || next === list.length) {\n\t\t\t\tarray.push(\n\t\t\t\t\tlist\n\t\t\t\t\t.slice(start, next)\n\t\t\t\t\t.map(i => data[i].latlng)\n\t\t\t\t);\n\t\t\t\tstart = next;\n\t\t\t}\n\t\t\treturn array;\n\t\t}, []);\n\n\t\treturn coords;\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findIndexForXCoord: function(x) {\n\t\treturn d3\n\t\t\t.bisector(d => d[this.options.xAttr])\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\n\t},\n\n\t/*\n\t * Finds a data entry for a given latlng of the map\n\t */\n\t_findIndexForLatLng: function(latlng) {\n\t\tlet result = null;\n\t\tlet d      = Infinity;\n\t\tthis._data.forEach((item, index) => {\n\t\t\tlet dist = latlng.distanceTo(item.latlng);\n\t\t\tif (dist < d) {\n\t\t\t\td = dist;\n\t\t\t\tresult = index;\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tif (this._chart.panes.brush.select(\".selection\").attr('width')) {\n\t\t\tthis._chart.panes.brush.call(this._brush.clear);\n\t\t\tthis._hideDiagramIndicator();\n\t\t\tthis.fire('reset_drag');\n\t\t}\n\t},\n\n\t_resetZoom: function() {\n\t\tif (this._zoom) {\n\t\t\tthis._zoom.transform(this._chart.svg, d3.zoomIdentity);\n\t\t}\n\t},\n\n\t/**\n\t * Display distance and altitude level (\"focus-rect\").\n\t */\n\t_showDiagramIndicator: function(item, xCoordinate) {\n\t\tlet opts        = this.options;\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\n\n\t\tthis._focusG.attr(\"display\", null);\n\n\t\tthis._focusline.call(\n\t\t\tD3.MouseFocusLine({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\theight: this._height()\n\t\t\t})\n\t\t);\n\t\tthis._focuslabel.call(\n\t\t\tD3.MouseFocusLabel({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\tyCoord: yCoordinate,\n\t\t\t\theight: this._height(),\n\t\t\t\twidth : this._width(),\n\t\t\t\tlabelX: d3.format(\".\"+ opts.decimalsX +\"f\")(item[opts.xAttr]) + \" \" + this._xLabel,\n\t\t\t\tlabelY: d3.format(\".\"+ opts.decimalsY +\"f\")(item[opts.yAttr]) + \" \" + this._yLabel\n\t\t\t})\n\t\t);\n\n\t\t// this._focuslabel.selectAll('tspan').data(Object.values(this._focuslabels));\n\n\t\tlet labels = this._props.focusLabels;\n\t\tlet tooltip = this._focuslabel.select('text');\n\t\tlet label;\n\n\t\tfor (var i in labels) {\n\t\t\tlabel = tooltip.select(\".mouse-focus-label-\" + labels[i].name);\n\n\t\t\tif (!label.size()) {\n\t\t\t\tlabel   = tooltip.append(\"svg:tspan\", \".mouse-focus-label-x\")\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-\" + labels[i].name)\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t}\n\n\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(item) );\n\n\t\t\tthis._focuslabel.select('.mouse-focus-label-x')\n\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t}\n\n\t},\n\n\t_hideDiagramIndicator: function() {\n\t\tthis._focusG.attr(\"display\", 'none');\n\t},\n});\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Marker = L.Class.extend({\n\n\tinitialize: function(options) {\n\t\tthis.options = options;\n\n\t\tif (this.options.imperial) {\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\t// this._container = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\n\t\t\tthis._focusline   = d3.create('svg:line');\n\t\t\tthis._focusmarker = d3.create(\"svg:circle\");\n\t\t\tthis._focuslabel  = d3.create(\"svg:text\");\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t// this._marker   = L.circleMarker([0, 0], { pane: 'overlayPane', radius: 6, fillColor: '#fff', fillOpacity:1, color: '#000', weight:1, interactive: false });\n\t\t\tthis._marker      = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\n\t\t}\n\n\t\tthis._focuslabels = {};\n\n\t\treturn this;\n\t},\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tlet g = this._container = d3.select(map.getPane('elevationPane')).select(\"svg > g\")\n\t\t\t\t.attr(\"class\", \"height-focus-group\");\n\t\t\tg.append(() => this._focusline.node());\n\t\t\tg.append(() => this._focusmarker.node());\n\t\t\tg.append(() => this._focuslabel.node());\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker.addTo(map, { pane: 'overlayPane' });\n\t\t}\n\t\treturn this;\n\t},\n\n\t/**\n\t * Update position marker (\"leaflet-marker\").\n\t */\n\tupdate: function(props) {\n\t\tif (props) this._props = props;\n\t\telse props = this._props;\n\n\t\tif(!props) return;\n\n\t\tif (props.options) this.options = props.options;\n\t\tif (!this._map) this.addTo(props.map);\n\n\t\tlet opts = this.options;\n\t\tlet map = this._map;\n\n\t\tthis._latlng = props.item.latlng;\n\n\t\tlet pos = map.latLngToLayerPoint(this._latlng);\n\n\t\tif (map._rotate) {\n\t\t\tpos = map.rotatedPointToMapPanePoint(pos);\n\t\t}\n\n\t\tlet point = L.extend({}, props.item, pos);\n\n\t\tif (this.options.marker == 'elevation-line') {\n\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\n\t\t\tlet normalizedY   = point.y - normalizedAlt;\n\n\t\t\tthis._container.classed(\"leaflet-hidden\", false);\n\n\t\t\tthis._focusmarker\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusMarker({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t}));\n\n\t\t\tthis._focusline\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLine({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t\tlength: normalizedY\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\tthis._focuslabel\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLabel({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: normalizedY,\n\t\t\t\t\t\tlabel : d3.format(\".\" + opts.decimalsY + \"f\")(point[opts.yAttr]) + \" \" + this._yLabel\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tlet labels = this._focuslabels;\n\t\t\tlet tooltip = this._focuslabel;\n\t\t\tlet label;\n\n\t\t\tfor (var i in labels) {\n\t\t\t\tlabel = tooltip.select(\".height-focus-\" + labels[i].name);\n\n\t\t\t\tif (!label.size()) {\n\t\t\t\t\tlabel   = tooltip.append(\"svg:tspan\")\n\t\t\t\t\t\t.attr(\"class\", \"height-focus-\" + labels[i].name)\n\t\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t\t}\n\n\t\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(props.item) );\n\n\t\t\t\tthis._focuslabel.select('.height-focus-y')\n\t\t\t\t\t.attr(\"dy\", \"-1.5em\");\n\t\t\t}\n\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.removeClass(this._marker.getElement(), 'leaflet-hidden');\n\t\t\tthis._marker.setLatLng(this._latlng);\n\t\t}\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\tremove: function() {\n\t\tthis._props = null;\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tif (this._container) this._container.classed(\"leaflet-hidden\", true);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.addClass(this._marker.getElement(), 'leaflet-hidden');\n\t\t}\n\t},\n\n\tgetLatLng: function() {\n\t\treturn this._latlng;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t_registerFocusLabel: function(props) {\n\t\tthis._focuslabels[props.name] = props;\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Summary = L.Class.extend({\n\tinitialize: function(opts, control) {\n\t\tthis.options = opts;\n\t\tthis.control = control;\n\n\t\tlet summary = this._container = _.create(\"div\", \"elevation-summary \" + (opts.summary ? opts.summary + \"-summary\" : ''));\n\t\t_.style(summary, 'max-width', opts.width ? opts.width + 'px' : '');\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container);\n\t},\n\n\treset: function() {\n\t\tthis._container.innerHTML = '';\n\t},\n\n\tappend: function(className, label, value) {\n\t\tthis._container.innerHTML += `<span class=\"${className}\"><span class=\"summarylabel\">${label}</span><span class=\"summaryvalue\">${value}</span></span>`;\n\t\treturn this;\n\t},\n\n\t_registerSummary: function(data) {\n\t\tfor (let i in data) {\n\t\t\tthis.append(i, L._(data[i].label), typeof data[i].value !== \"function\" ? data[i].value : data[i].value(this.control.track_info));\n\t\t}\n\t}\n\n});\n","import * as _ from './utils';\n\nexport var Options = {\n\tautofitBounds: true,\n\tautohide: !L.Browser.mobile,\n\tautohideMarker: true,\n\talmostover: true,\n\taltitude: true,\n\tcollapsed: false,\n\tdetached: true,\n\tdistance: true,\n\tdistanceFactor: 1,\n\tdistanceMarkers: false,\n\tdecimalsX: 2,\n\tdecimalsY: 0,\n\tdragging: !L.Browser.mobile,\n\tdownloadLink: 'link',\n\televationDiv: \"#elevation-div\",\n\tfollowMarker: true,\n\tforceAxisBounds: false,\n\tgpxOptions: {\n\t\tasync: true,\n\t\tmarker_options: {\n\t\t\tstartIconUrl: null,\n\t\t\tendIconUrl: null,\n\t\t\tshadowUrl: null,\n\t\t\twptIcons: {\n\t\t\t\t'': L.divIcon({\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\n\t\t\t\t\ticonSize: [30, 30],\n\t\t\t\t\ticonAnchor: [8, 30],\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t},\n\theight: 200,\n\theightFactor: 1,\n\timperial: false,\n\tinterpolation: \"curveLinear\",\n\tlazyLoadJS: true,\n\tlegend: true,\n\tloadData: {\n\t\tdefer: false,\n\t\tlazy: false,\n\t},\n\tmargins: {\n\t\ttop: 30,\n\t\tright: 30,\n\t\tbottom: 30,\n\t\tleft: 40\n\t},\n\tmarker: 'elevation-line',\n\tmarkerIcon: L.divIcon({\n\t\tclassName: 'elevation-position-marker',\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\n\t\ticonSize: [32, 32],\n\t\ticonAnchor: [16, 16],\n\t}),\n\tplaceholder: false,\n\tposition: \"topright\",\n\tpolyline: {\n\t\tclassName: 'elevation-polyline',\n\t\tcolor: '#000',\n\t\topacity: 0.75,\n\t\tweight: 5,\n\t\tlineCap: 'round'\n\t},\n\tpolylineSegments: {\n\t\tclassName: 'elevation-polyline-segments',\n\t\tcolor: '#F00',\n\t\tinteractive: false,\n\t},\n\tpreferCanvas: false,\n\treverseCoords: false,\n\truler: true,\n\tskipNullZCoords: false,\n\ttheme: \"lightblue-theme\",\n\tresponsive: true,\n\tsummary: 'inline',\n\tslope: false,\n\tspeed: false,\n\tsLimit: undefined,\n\ttime: false,\n\ttimeFactor: 3600,\n\ttimeFormat: false,\n\tsDeltaMax: undefined,\n\tsInterpolation: \"curveStepAfter\",\n\tsRange: undefined,\n\twidth: 600,\n\txAttr: \"dist\",\n\txLabel: \"km\",\n\txTicks: undefined,\n\tyAttr: \"z\",\n\tyAxisMax: undefined,\n\tyAxisMin: undefined,\n\tyLabel: \"m\",\n\tyTicks: undefined,\n\tzFollow: false,\n\tzooming: !L.Browser.Mobile,\n};\n","import 'leaflet-i18n';\nimport * as _      from './utils';\nimport * as D3     from './components';\nimport { Chart }   from './chart';\nimport { Marker }  from './marker';\nimport { Summary } from './summary';\nimport { Options } from './options';\n\nexport const Elevation = L.Control.Elevation = L.Control.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\toptions: Options,\n\t__mileFactor: 0.621371,\n\t__footFactor: 3.28084,\n\t__D3:          'https://unpkg.com/d3@6.5.0/dist/d3.min.js',\n\t__TOGEOJSON:   'https://unpkg.com/@tmcw/togeojson@4.3.0/dist/togeojson.umd.js',\n\t__LGEOMUTIL:   'https://unpkg.com/leaflet-geometryutil@0.9.3/src/leaflet.geometryutil.js',\n\t__LALMOSTOVER: 'https://unpkg.com/leaflet-almostover@1.0.1/src/leaflet.almostover.js',\n\t__LDISTANCEM:  'https://unpkg.com/@raruto/leaflet-elevation@1.6.7/libs/leaflet-distance-marker.min.js',\n\n\t/*\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\n\t */\n\taddData: function(d, layer) {\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\n\t\t\tlayer = d;\n\t\t}\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._addData(d);\n\t\t\tthis._addLayer(layer);\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\n\t\t});\n\t},\n\n\t/**\n\t * Adds the control to the given map.\n\t */\n\taddTo: function(map) {\n\t\tif (this.options.detached) {\n\t\t\tlet eleDiv = this._initElevationDiv();\n\t\t\tif (!eleDiv.isConnected) _.insert(map.getContainer(), eleDiv, 'afterend');\n\t\t\t_.append(eleDiv, this.onAdd(map));\n\t\t} else {\n\t\t\tL.Control.prototype.addTo.call(this, map);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/*\n\t * Reset data and display\n\t */\n\tclear: function() {\n\t\tif (this._marker) this._marker.remove();\n\t\tif (this._chart)  this._chart.clear();\n\t\tif (this._layers) this._layers.clearLayers();\n\n\t\tthis._data      = [];\n\t\tthis.track_info = {};\n\n\t\tthis._fireEvt(\"eledata_clear\");\n\t},\n\n\t/**\n\t * Disable chart brushing.\n\t */\n\tdisableBrush: function() {\n\t\tthis._chart._brushEnabled = false;\n\t\tthis._resetDrag();\n\t},\n\n\t/**\n\t * Enable chart brushing.\n\t */\n\tenableBrush: function() {\n\t\tthis._chart._brushEnabled = true;\n\t},\n\n\t/**\n\t * Alias for enableBrush\n\t */\n\tenableDragging: function() {\n\t\tthis.enableBrushing();\n\t},\n\n\t/**\n\t * Alias for disableBrush\n\t */\n\tdisableDragging: function() {\n\t\tthis.disableBrushing();\n\t},\n\n\t/**\n\t * Disable chart zooming.\n\t */\n\tdisableZoom: function() {\n\t\tthis._chart._zoomEnabled = false;\n\t\tthis._chart._resetZoom();\n\t},\n\n\t/**\n\t * Enable chart zooming.\n\t */\n\tenableZoom: function() {\n\t\tthis._chart._zoomEnabled = true;\n\t},\n\n\t/**\n\t * Sets a map view that contains the given geographical bounds.\n\t */\n\tfitBounds: function(bounds) {\n\t\tbounds = bounds || this.getBounds();\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\n\t},\n\n\tgetBounds: function(data) {\n\t\tdata = data || this._data;\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\n\t},\n\n\t/**\n\t * Get default zoom level when \"followMarker\" is true.\n\t */\n\tgetZFollow: function() {\n\t\treturn this._zFollow;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\thide: function() {\n\t\t_.style(this._container, \"display\", \"none\");\n\t},\n\n\t/**\n\t * Initialize chart control \"options\" and \"container\".\n\t */\n\tinitialize: function(options) {\n\t\tthis._data           = [];\n\t\tthis._layers         = L.featureGroup();\n\t\tthis._markedSegments = L.polyline([]);\n\t\tthis._chartEnabled   = true,\n\n\t\tthis.track_info      = {};\n\n\t\tthis.options         = _.deepMerge({}, this.options, options);\n\n\t\tthis._zFollow        = this.options.zFollow;\n\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\n\t\tif (this.options.placeholder)  this.options.loadData.lazy = this.options.loadData.defer = true;\n\n\t\tif (this.options.legend)       this.options.margins.bottom += 30;\n\n\t\tif (this.options.theme)        this.options.polylineSegments.className += ' ' + this.options.theme;\n\n\t\tthis._markedSegments.setStyle(this.options.polylineSegments);\n\n\t\t// this._resizeChart   = _.debounce(this._resizeChart,   300, this);\n\t\t// this._resizeChart = L.Util.throttle(this._resizeChart, 300, this);\n\n\t\t// if (L.Browser.mobile) {\n\t\t// \tthis._updateChart   = _.debounce(this._updateChart,   300, this);\n\t\t// \tthis._updateSummary = _.debounce(this._updateSummary, 300, this);\n\t\t// }\n\n\t\t// Leaflet canvas renderer colors\n\t\tL.extend(D3.Colors, this.options.colors || {});\n\t},\n\n\t/**\n\t * Alias for loadData\n\t */\n\tload: function(data, opts) {\n\t\tthis.loadData(data, opts);\n\t},\n\n\t/**\n\t * Alias for addTo\n\t */\n\tloadChart: function(map) {\n\t\tthis.addTo(map);\n\t},\n\n\t/**\n\t * Load elevation data (GPX, GeoJSON or KML).\n\t */\n\tloadData: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tif (opts.defer) {\n\t\t\tthis.loadDefer(data, opts);\n\t\t} else if (opts.lazy) {\n\t\t\tthis.loadLazy(data, opts);\n\t\t} else if (_.isXMLDoc(data)) {\n\t\t\tthis.loadXML(data);\n\t\t} else if (_.isJSONDoc(data)) {\n\t\t\tthis.loadGeoJSON(data);\n\t\t} else {\n\t\t\tthis.loadFile(data);\n\t\t}\n\t},\n\n\t/**\n\t * Wait for document load before download data.\n\t */\n\tloadDefer: function(data, opts) {\n\t\topts       = L.extend({}, this.options.loadData, opts);\n\t\topts.defer = false;\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\n\t},\n\n\t/**\n\t * Load data from a remote url.\n\t */\n\tloadFile: function(url) {\n\t\tfetch(url)\n\t\t\t.then((response) => response.text())\n\t\t\t.then((data)     => {\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\n\t\t\t})\n\t\t\t.catch((err) => console.warn(err));\n\t},\n\n\t/**\n\t * Load raw GeoJSON data.\n\t */\n\tloadGeoJSON: function(data) {\n\t\t_.GeoJSONLoader(data, this);\n\t},\n\n\t/**\n\t * Alias for loadXML\n\t */\n\tloadGPX: function(data){\n\t\tthis.loadXML(data);\n\t},\n\n\t/**\n\t * Load raw XML data.\n\t */\n\tloadXML: function(data) {\n\t\tElevation._togeojsonLazyLoader = _.lazyLoader(\n\t\t\tthis.__TOGEOJSON,\n\t\t\ttypeof toGeoJSON !== 'function' || !this.options.lazyLoadJS,\n\t\t\tElevation._togeojsonLazyLoader\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tlet xml     = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t\tlet type    = xml.documentElement.tagName.toLowerCase(); // \"kml\" or \"gpx\"\n\t\t\t\tif (!(type in toGeoJSON)) {\n\t\t\t\t\ttype = xml.documentElement.tagName == \"TrainingCenterDatabase\" ? 'tcx' : 'gpx';\n\t\t\t\t}\n\t\t\t\tlet geojson = toGeoJSON[type](xml);\n\t\t\t\tlet name    = xml.getElementsByTagName('name');\n\t\t\t\tif(name[0]) { geojson.name = name[0].innerHTML; }\n\t\t\t\telse if(this._downloadURL) { geojson.name = this._downloadURL.split('/').pop().split('#')[0].split('?')[0]; }\n\n\t\t\t\treturn this.loadGeoJSON(geojson, this);\n\t\t\t}\n\t\t);\n\t},\n\n\t/**\n\t * Wait for chart container visible before download data.\n\t */\n\tloadLazy: function(data, opts) {\n\t\topts     = L.extend({}, this.options.loadData, opts);\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\n\t\t_.waitHolder(elem)\n\t\t\t.then(() => {\n\t\t\t\topts.lazy = false;\n\t\t\t\tthis.loadData(data, opts)\n\t\t\t\tthis.once('eledata_loaded', () => this.placeholder.parentNode.removeChild(elem));\n\t\t\t});\n\t},\n\n\t/**\n\t * Create container DOM element and related event listeners.\n\t * Called on control.addTo(map).\n\t */\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\n\n\t\tif (!this.options.detached) {\n\t\t\t_.addClass(container, 'leaflet-control');\n\t\t}\n\n\t\tif (this.options.placeholder && !this._data.length) {\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\n\t\t\t_.insert(container, this.placeholder, 'afterbegin');\n\t\t}\n\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._initButton(container);\n\t\t\tthis._initChart(container);\n\t\t\tthis._initSummary(container);\n\t\t\tthis._initMarker(map);\n\t\t\tthis._initLayer(map);\n\n\t\t\tmap\n\t\t\t\t.on('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t\t.on('resize',                        this._resetView,     this)\n\t\t\t\t.on('resize',                        this._resizeChart,   this)\n\t\t\t\t.on('rotate',                        this._rotateMarker,  this)\n\t\t\t\t.on('mousedown',                     this._resetDrag,     this);\n\n\t\t\t_.on(map.getContainer(), 'mousewheel', this._resetDrag,     this);\n\t\t\t_.on(map.getContainer(), 'touchstart', this._resetDrag,     this);\n\n\t\t\tthis\n\t\t\t\t.on('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t\t.on('eledata_added eledata_loaded',  this._updateSummary, this);\n\n\t\t\tthis._updateChart();\n\t\t\tthis._updateSummary();\n\t\t});\n\n\t\treturn container;\n\t},\n\n\t/**\n\t * Clean up control code and related event listeners.\n\t * Called on control.remove().\n\t */\n\tonRemove: function(map) {\n\t\tthis._container = null;\n\n\t\tmap\n\t\t\t.off('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t.off('resize',                        this._resetView,     this)\n\t\t\t.off('resize',                        this._resizeChart,   this)\n\t\t\t.off('mousedown',                     this._resetDrag,     this);\n\n\t\t_.off(map.getContainer(), 'mousewheel', this._resetDrag,     this);\n\t\t_.off(map.getContainer(), 'touchstart', this._resetDrag,     this);\n\n\t\tthis\n\t\t\t.off('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t.off('eledata_added eledata_loaded',  this._updateSummary, this);\n\t},\n\n\t/**\n\t * Redraws the chart control. Sometimes useful after screen resize.\n\t */\n\tredraw: function() {\n\t\tthis._resizeChart();\n\t},\n\n\t/**\n\t * Set default zoom level when \"followMarker\" is true.\n\t */\n\tsetZFollow: function(zoom) {\n\t\tthis._zFollow = zoom;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\tshow: function() {\n\t\t_.style(this._container, \"display\", \"block\");\n\t},\n\n\t/*\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\n\t */\n\t_addData: function(d) {\n\t\tif (!d) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet geom = d.geometry;\n\t\tif (geom) {\n\t\t\tswitch (geom.type) {\n\t\t\t\tcase 'LineString':\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'MultiLineString':\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\n\t\t\t}\n\t\t}\n\n\t\tif (d.type === \"FeatureCollection\") {\n\t\t\t_.each(d.features, feature => this._addData(feature));\n\t\t}\n\n\t\tif (d._latlngs) {\n\t\t\tthis._addGPXData(d._latlngs);\n\t\t}\n\t},\n\n\t/*\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\n\t */\n\t_addGeoJSONData: function(coords) {\n\t\t_.each(coords, point => {\n\t\t\tthis._addPoint(point[1], point[0], point[2]);\n\t\t\tthis._fireEvt(\"elepoint_added\", { point: point, index: this._data.length - 1 });\n\t\t});\n\t\tthis._fireEvt(\"eletrack_added\", { coords: coords, index: this._data.length - 1 });\n\t},\n\n\t/*\n\t * Parsing function for GPX data and their elevation in z-coordinate\n\t */\n\t_addGPXData: function(coords) {\n\t\t_.each(coords, point => {\n\t\t\tthis._addPoint(point.lat, point.lng, point.meta.ele);\n\t\t\tthis._fireEvt(\"elepoint_added\", { point: point, index: this._data.length - 1 });\n\t\t});\n\t\tthis._fireEvt(\"eletrack_added\", { coords: coords, index: this._data.length - 1 });\n\t},\n\n\t/*\n\t * Parse and push a single (x, y, z) point to current elevation profile.\n\t */\n\t_addPoint: function(x, y, z) {\n\t\tif (this.options.reverseCoords) {\n\t\t\t[x, y] = [y, x];\n\t\t}\n\n\t\tthis._data.push({\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t\tz: z,\n\t\t\tlatlng: L.latLng(x, y, z)\n\t\t});\n\n\t\tthis._fireEvt(\"eledata_updated\", { index: this._data.length - 1 });\n\t},\n\n\t_addLayer: function(layer) {\n\t\tif (layer) this._layers.addLayer(layer)\n\t},\n\n\t/**\n\t * Adds the control to the given \"detached\" div.\n\t */\n\t_initElevationDiv: function() {\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\n\t\tif (!eleDiv) {\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\n\t\t\teleDiv                    = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\n\t\t}\n\t\tif (this.options.detached) {\n\t\t\t_.replaceClass(eleDiv, 'leaflet-control', 'elevation-detached');\n\t\t}\n\t\tthis.eleDiv = eleDiv;\n\t\treturn this.eleDiv;\n\t},\n\n\t/*\n\t * Collapse current chart control.\n\t */\n\t_collapse: function() {\n\t\t_.replaceClass(this._container, 'elevation-expanded', 'elevation-collapsed');\n\t},\n\n\t/*\n\t * Expand current chart control.\n\t */\n\t_expand: function() {\n\t\t_.replaceClass(this._container, 'elevation-collapsed', 'elevation-expanded');\n\t},\n\n\t/*\n\t * Finds a data entry for the given LatLng\n\t */\n\t_findItemForLatLng: function(latlng) {\n\t\treturn this._data[this._chart._findIndexForLatLng(latlng)];\n\t},\n\n\t/*\n\t * Finds a data entry for the given xDiagCoord\n\t */\n\t_findItemForX: function(x) {\n\t\treturn this._data[this._chart._findIndexForXCoord(x)];\n\t},\n\n\t/**\n\t * Fires an event of the specified type.\n\t */\n\t_fireEvt: function(type, data, propagate) {\n\t\tif (this.fire) this.fire(type, data, propagate);\n\t\tif (this._map) this._map.fire(type, data, propagate);\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tif (this._chart) return this._chart._height();\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\t_hideMarker: function() {\n\t\tif (this.options.autohideMarker) {\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Generate \"svg\" chart DOM element.\n\t */\n\t_initChart: function(container) {\n\t\tlet opts    = this.options;\n\n\t\topts.xTicks = this._xTicks();\n\t\topts.yTicks = this._yTicks();\n\n\t\tif (opts.responsive) {\n\t\t\tif (opts.detached) {\n\t\t\t\tlet { offsetWidth, offsetHeight}             = this.eleDiv;\n\t\t\t\tif (offsetWidth > 0)             opts.width  = offsetWidth;\n\t\t\t\tif (offsetHeight > 20)           opts.height = offsetHeight - 20; // 20 = horizontal scrollbar size.\n\t\t\t} else {\n\t\t\t\tlet { clientWidth }                          = this._map.getContainer();\n\t\t\t\topts._maxWidth                               = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\n\t\t\t\tthis._container.style.maxWidth               = opts._maxWidth + 'px';\n\t\t\t\tif (opts._maxWidth > clientWidth) opts.width = clientWidth - 30;\n\t\t\t}\n\t\t}\n\n\t\tlet chart = this._chart = new Chart(opts, this);\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\td3\n\t\t\t.select(container)\n\t\t\t.call(chart.render())\n\n\t\tchart\n\t\t\t.on('reset_drag',     this._hideMarker,                     this)\n\t\t\t.on('mouse_enter',    this._fireEvt.bind('elechart_enter'), this)\n\t\t\t.on('dragged',        this._dragendHandler,                 this)\n\t\t\t.on('mouse_move',     this._mousemoveHandler,               this)\n\t\t\t.on('mouse_out',      this._mouseoutHandler,                this)\n\t\t\t.on('ruler_filter',   this._rulerFilterHandler,             this)\n\t\t\t.on('zoom',           this._updateChart,                    this)\n\t\t\t.on('elepath_toggle', this._toggleChartHandler,             this)\n\t\t\t.on('margins_updated',this._resizeChart,                    this);\n\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\n\n\t\tthis._fireEvt(\"elechart_init\");\n\t},\n\n\t_initLayer: function() {\n\t\tthis._layers\n\t\t\t.on('layeradd layerremove', (e) => {\n\t\t\t\tlet layer = e.layer\n\t\t\t\tlet node  = layer.getElement && layer.getElement();\n\t\t\t\t_.toggleClass(node,  this.options.polyline.className + ' ' + this.options.theme, e.type == 'layeradd');\n\t\t\t\t_.toggleEvent(layer, \"mousemove\", this._mousemoveLayerHandler.bind(this),        e.type == 'layeradd')\n\t\t\t\t_.toggleEvent(layer, \"mouseout\",  this._mouseoutHandler.bind(this),              e.type == 'layeradd');\n\t\t\t});\n\t},\n\n\t_initMarker: function(map) {\n\t\tlet pane                   = map.getPane('elevationPane');\n\t\tif (!pane) {\n\t\t\tpane = this._pane        = map.createPane('elevationPane', map.getPane('norotatePane') || map.getPane('mapPane'));\n\t\t\tpane.style.zIndex        = 625; // This pane is above markers but below popups.\n\t\t\tpane.style.pointerEvents = 'none';\n\t\t}\n\n\t\tif (this._renderer) this._renderer.remove()\n\t\tthis._renderer             = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\n\t\tthis._marker               = new Marker(this.options);\n\n\t\tthis._fireEvt(\"elechart_marker\");\n\t},\n\n\t/**\n\t * Inspired by L.Control.Layers\n\t */\n\t_initButton: function(container) {\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tif (!this.options.detached) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container);\n\t\t\t//.disableScrollPropagation(container);\n\t\t}\n\n\t\tif (L.Browser.mobile) {\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\n\t\t}\n\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\n\n\t\tif (!this.options.detached) {\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\n\n\t\t\tif (this.options.collapsed) {\n\t\t\t\tthis._collapse();\n\t\t\t\tif (this.options.autohide) {\n\t\t\t\t\t_.on(container, 'mouseover', this._expand,   this);\n\t\t\t\t\t_.on(container, 'mouseout',  this._collapse, this);\n\t\t\t\t} else {\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\n\t\t\t\t}\n\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\n\n\t\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t\t// TODO: keyboard accessibility\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO: handle autohide when detached=true\n\t\t}\n\t},\n\n\t_initSummary: function(container) {\n\t\tlet summary = this._summary = new Summary({ summary: this.options.summary }, this);\n\n\t\td3\n\t\t\t.select(container)\n\t\t\t.call(summary.render());\n\n\t\tthis.summaryDiv = this._summary._container;\n\t},\n\n\t_dragendHandler: function(e) {\n\t\tthis._hideMarker();\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\n\n\t\tthis._fireEvt(\"elechart_dragged\");\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(e) {\n\t\tif (!this._data.length || !this._chartEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tlet item = this._findItemForX(e.xCoord);\n\n\t\tif (item) {\n\t\t\tlet xCoord = e.xCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\t\t\tthis._setMapView(item);\n\n\t\t\tif (this._map) {\n\t\t\t\t_.addClass(this._map.getContainer(), 'elechart-hover');\n\t\t\t}\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t\tthis._fireEvt(\"elechart_hover\",  { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles mouseover events of the data layers on the map.\n\t */\n\t_mousemoveLayerHandler: function(e) {\n\t\tif (!this._data.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this._findItemForLatLng(e.latlng);\n\t\tif (item) {\n\t\t\tlet xCoord = item.xDiagCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tif (!this.options.detached) {\n\t\t\tthis._hideMarker();\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t}\n\n\t\tif (this._map) {\n\t\t\t_.removeClass(this._map.getContainer(), 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_leave\");\n\t},\n\n\t/*\n\t * Handles the mouesewheel over the chart.\n\t */\n\t_mousewheelHandler: function(e) {\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\n\t\tlet z  = this._map.getZoom() + Math.sign(e.deltaY);\n\t\tthis._resetDrag();\n\t\tthis._map.flyTo(ll, z);\n\t},\n\n\t/**\n\t * Add a waypoint marker to the diagram\n\t */\n\t_registerCheckPoint: function(props) {\n\t\tthis.on(\"elechart_updated\", () => this._chart._registerCheckPoint(props));\n\t},\n\n\t/**\n\t * Add chart profile to diagram\n\t */\n\t_registerAreaPath: function(props) {\n\t\tthis.on(\"elechart_init\", () => this._chart._registerAreaPath(props));\n\t},\n\n\t/**\n\t * Add chart grid to diagram\n\t */\n\t_registerAxisGrid: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisGrid(props));\n\t},\n\n\t/**\n\t * Add chart axis to diagram\n\t */\n\t_registerAxisScale: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisScale(props));\n\t},\n\n\t/**\n\t * Add chart or marker tooltip info\n\t */\n\t_registerFocusLabel: function(props) {\n\t\tif (props.chart) {\n\t\t\tlet label = L.extend({}, props, { value: props.chart });\n\t\t\tthis.on(\"elechart_init\",   () => this._chart._registerFocusLabel(label));\n\t\t}\n\t\tif (props.marker) {\n\t\t\tlet label = L.extend({}, props, { value: props.marker });\n\t\t\tthis.on(\"elechart_marker\", () => this._marker._registerFocusLabel(label));\n\t\t}\n\t},\n\n\t/**\n\t * Add summary info to diagram\n\t */\n\t_registerSummary: function(props) {\n\t\tthis.on('elechart_summary',  () => this._summary._registerSummary(props));\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tthis._chart._resetDrag();\n\t\tthis._hideMarker();\n\t},\n\n\t/**\n\t * Resets drag, marker and bounds.\n\t */\n\t_resetView: function() {\n\t\tif (this._map && this._map._isFullscreen) return;\n\t\tthis._resetDrag();\n\t\tthis._hideMarker();\n\t\tif (this.options.autofitBounds) {\n\t\t\tthis.fitBounds();\n\t\t}\n\t},\n\n\t/**\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\n\t */\n\t_resizeChart: function() {\n\t\t// prevent displaying chart on resize if hidden\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\n\n\t\tlet opts = this.options;\n\n\t\tif (opts.responsive) {\n\t\t\tlet newWidth;\n\t\t\tif (opts.detached) {\n\t\t\t\tnewWidth = (this.eleDiv || this._container).offsetWidth;\n\t\t\t} else {\n\t\t\t\tlet { clientWidth } = this._map.getContainer();\n\t\t\t\tnewWidth = opts._maxWidth > clientWidth ? clientWidth - 30 : opts._maxWidth;\n\t\t\t}\n\t\t\tif (newWidth) {\n\t\t\t\tlet chart  = this._chart;\n\t\t\t\topts.width = newWidth;\n\t\t\t\tif (chart && chart._chart) {\n\t\t\t\t\tchart._chart._resize(opts);\n\t\t\t\t\topts.xTicks = this._xTicks();\n\t\t\t\t\topts.yTicks = this._yTicks();\n\t\t\t\t\tthis._updateChart();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._updateMapSegments();\n\t},\n\n\t/**\n\t * Handles the drag event over the ruler filter.\n\t */\n\t_rulerFilterHandler: function(e) {\n\t\tthis._updateMapSegments(e.coords);\n\t},\n\n\t/**\n\t * Collapse or Expand current chart control.\n\t */\n\t_toggle: function() {\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\n\t\t\tthis._collapse();\n\t\telse\n\t\t\tthis._expand();\n\t},\n\n\t/**\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\n\t */\n\t_setMapView: function(item) {\n\t\tif (!this.options.followMarker || !this._map) return;\n\t\tlet zoom = this._map.getZoom();\n\t\tif (\"number\" === typeof this._zFollow) {\n\t\t\tif (zoom < this._zFollow) zoom = this._zFollow;\n\t\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t\t} else if (!this._map.getBounds().contains(item.latlng)) {\n\t\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t\t}\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_toggleChartHandler: function(e) {\n\t\tlet { path, name, enabled } = e;\n\n\t\tthis._chartEnabled = this._chart._hasActiveLayers();\n\n\t\t// toggle layer visibility on empty chart\n\t\tthis._layers.eachLayer(layer => {\n\t\t\tlet node = layer.getElement && layer.getElement();\n\t\t\t_.toggleClass(node, this.options.polyline.className + ' ' + this.options.theme, this._chartEnabled);\n\t\t\t}\n\t\t);\n\n\t\t// toggle option value (eg. altitude = { 'disabled' || 'disabled' })\n\t\tthis.options[name] = !enabled && this.options[name] == 'disabled' ? 'enabled' : 'disabled';\n\n\t\t// remove marker on empty chart\n\t\tif (!this._chartEnabled) {\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Calculates [x, y] domain and then update chart.\n\t */\n\t_updateChart: function() {\n\t\tif (!this._data.length || !this._container) return;\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tthis._fireEvt(\"elechart_area\");\n\n\t\tthis._chart.update({ data: this._data, options: this.options });\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\tthis._fireEvt('elechart_updated');\n\t},\n\n\t/*\n\t * Update the position/height indicator marker drawn onto the map\n\t */\n\t_updateMarker: function(item) {\n\t\tif (!this._marker) return;\n\t\tthis._marker.update({\n\t\t\tmap         : this._map,\n\t\t\titem        : item,\n\t\t\tmaxElevation: this.track_info.elevation_max || 0,\n\t\t\toptions     : this.options\n\t\t});\n\t},\n\n\t/**\n\t * Fix marker rotation on rotated maps\n\t */\n\t_rotateMarker: function() {\n\t\tif (!this._marker) return;\n\t\tthis._marker.update();\n\t},\n\n\t/**\n\t * Highlight track segments on the map.\n\t */\n\t_updateMapSegments: function(coords) {\n\t\tthis._markedSegments.setLatLngs(coords || []);\n\t\tif (coords && this._map && !this._map.hasLayer(this._markedSegments)) {\n\t\t\tthis._markedSegments.addTo(this._map);\n\t\t}\n\t},\n\n\t/**\n\t * Update chart summary.\n\t */\n\t_updateSummary: function() {\n\t\tthis._summary.reset();\n\n\t\tif (this.options.summary) {\n\t\t\tthis._fireEvt(\"elechart_summary\");\n\t\t}\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\n\t\t\t};\n\t\t};\n\t},\n\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tif (this._chart) return this._chart._width();\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n\t/**\n\t * Calculate chart xTicks\n\t */\n\t_xTicks: function() {\n\t\tif (this.__xTicks) this.__xTicks = this.options.xTicks;\n\t\treturn this.__xTicks || Math.round(this._width() / 75);\n\t},\n\n\t/**\n\t * Calculate chart yTicks\n\t */\n\t_yTicks: function() {\n\t\tif (this.__yTicks) this.__yTicks = this.options.yTicks;\n\t\treturn this.__yTicks || Math.round(this._height() / 30);\n\t}\n\n});\n\n/**\n * Attach here some useful elevation hooks.\n */\nElevation.addInitHook(function() {\n\n\tthis.on('waypoint_added', function(e) {\n\t\tlet p = e.point,\n\t\t\tpop = p._popup;\n\t\tif (pop) {\n\t\t\tpop.options.className = 'elevation-popup';\n\t\t}\n\t\tif (pop && pop._content) {\n\t\t\tpop._content = decodeURI(pop._content);\n\t\t\tp.bindTooltip(pop._content, { direction: 'auto', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\n\t\t}\n\t});\n\n\tthis.on(\"eletrack_download\", function(e) {\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\n\t\t\te.confirm();\n\t\t}\n\t});\n\n\tthis.on('eledata_loaded', function(e) {\n\t\tlet map   = this._map;\n\t\tlet layer = e.layer;\n\t\tif (!map) {\n\t\t\tconsole.warn(\"Undefined elevation map object\");\n\t\t\treturn;\n\t\t}\n\t\tmap.once('layeradd',   (e) => this.options.autofitBounds && this.fitBounds(layer.getBounds()));\n\n\t\tif (L.Browser.mobile) {\n\n\t\t\tif (this.options.polyline) layer.addTo(map);\n\n\t\t} else {\n\n\t\t\t// leaflet-geometryutil\n\t\t\tElevation._geomutilLazyLoader = _.lazyLoader(\n\t\t\t\tthis.__LGEOMUTIL,\n\t\t\t\ttypeof L.GeometryUtil !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\tElevation._geomutilLazyLoader\n\t\t\t).then(\n\t\t\t\t() => {\n\n\t\t\t\t\t// leaflet-almostover\n\t\t\t\t\tif (this.options.almostOver) {\n\t\t\t\t\t\tElevation._almostoverLazyLoader = _.lazyLoader(\n\t\t\t\t\t\t\tthis.__LALMOSTOVER,\n\t\t\t\t\t\t\ttypeof L.Handler.AlmostOver  !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\t\t\t\tElevation._almostoverLazyLoader\n\t\t\t\t\t\t).then(\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tmap.addHandler('almostOver',L.Handler.AlmostOver)\n\t\t\t\t\t\t\t\tif (L.GeometryUtil && map.almostOver && map.almostOver.enabled()) {\n\t\t\t\t\t\t\t\t\tmap.almostOver.addLayer(layer);\n\t\t\t\t\t\t\t\t\tmap\n\t\t\t\t\t\t\t\t\t\t.on('almost:move', (e) => this._mousemoveLayerHandler(e))\n\t\t\t\t\t\t\t\t\t\t.on('almost:out',  (e) => this._mouseoutHandler(e));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// leaflet-distance-markers\n\t\t\t\t\tif (this.options.distanceMarkers) {\n\t\t\t\t\t\tElevation._distanceMarkersLazyLoader = _.lazyLoader(\n\t\t\t\t\t\t\tthis.__LDISTANCEM,\n\t\t\t\t\t\t\ttypeof L.DistanceMarkers  !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\t\t\t\tElevation._distanceMarkersLazyLoader\n\t\t\t\t\t\t).then(() => this.options.polyline && layer.addTo(map));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (this.options.polyline) layer.addTo(map);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t);\n\t\t}\n\t});\n\n\t// Basic canvas renderer support.\n\tlet oldProto = L.Canvas.prototype._fillStroke;\n\tlet control  = this;\n\tL.Canvas.include({\n\t\t_fillStroke: function(ctx, layer) {\n\t\t\tif (control._layers.hasLayer(layer)) {\n\n\t\t\t\tlet theme      = control.options.theme.replace('-theme', '');\n\t\t\t\tlet color      = D3.Colors[theme] || {};\n\t\t\t\tlet options    = layer.options;\n\n\t\t\t\toptions.color  = color.line || color.area || theme;\n\t\t\t\toptions.stroke = !!options.color;\n\n\t\t\t\toldProto.call(this, ctx, layer);\n\n\t\t\t\tif (options.stroke && options.weight !== 0) {\n\t\t\t\t\tlet oldVal                   = ctx.globalCompositeOperation || 'source-over';\n\t\t\t\t\tctx.globalCompositeOperation = 'destination-over'\n\t\t\t\t\tctx.strokeStyle              = '#FFF';\n\t\t\t\t\tctx.lineWidth                = options.weight * 1.75;\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.globalCompositeOperation = oldVal;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\toldProto.call(this, ctx, layer);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Partially fix: https://github.com/Raruto/leaflet-elevation/issues/81#issuecomment-713477050\n\tthis.on('elechart_init', function() {\n\t\tthis.once('elechart_change elechart_hover', function(e) {\n\t\t\tif (this._chartEnabled) {\n\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t}\n\t\t\tthis._updateMarker(e.data);\n\t\t});\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts     = this.options;\n\tlet distance = {};\n\n\tif (this.options.imperial) {\n\t\tthis._distanceFactor = this.__mileFactor;\n\t\tthis._xLabel         = \"mi\";\n\t} else {\n\t\tthis._distanceFactor = opts.distanceFactor;\n\t\tthis._xLabel         = opts.xLabel;\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data = this._data;\n\t\tlet i    = e.index;\n\n\t\tlet track = this.track_info;\n\t\tlet dist  = track.distance || 0;\n\n\t\tlet curr = data[i].latlng;\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\tdist += Math.round(delta / 1000 * 100000) / 100000; // handles floating points calc\n\n\t\tdata[i].dist = dist;\n\n\t\ttrack.distance = dist;\n\t});\n\n\tthis.on(\"elechart_axis\", function() {\n\n\t\tthis._chart._registerAxisGrid({\n\t\t\taxis      : \"x\",\n\t\t\tposition  : \"bottom\",\n\t\t\tscale     : this._chart._x,\n\t\t});\n\n\t});\n\n\tif (this.options.distance != \"summary\") {\n\n\t\tthis.on(\"elechart_axis\", function() {\n\n\t\t\tdistance.x     = this._chart._x;\n\t\t\tdistance.label = this._chart._xLabel;\n\n\t\t\tthis._chart._registerAxisScale({\n\t\t\t\taxis    : \"x\",\n\t\t\t\tposition: \"bottom\",\n\t\t\t\tscale   : distance.x,\n\t\t\t\tlabel   : distance.label,\n\t\t\t\tlabelY  : 25,\n\t\t\t\tlabelX  : () => this._width() + 6,\n\t\t\t\tname    : \"distance\",\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tthis._registerSummary({\n\t\t\"totlen\"  : {\n\t\t\tlabel: \"Total Length: \",\n\t\t\tvalue: (track) => (track.distance || 0).toFixed(2) + '&nbsp;' + this._xLabel\n\t\t}\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts     = this.options;\n\tlet altitude = {};\n\n\tif (opts.imperial) {\n\t\tthis._heightFactor = this.__footFactor;\n\t\tthis._yLabel       = \"ft\";\n\t} else {\n\t\tthis._heightFactor = opts.heightFactor;\n\t\tthis._yLabel       = opts.yLabel;\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data   = this._data;\n\t\tlet i      = e.index;\n\t\tlet z      = data[i].z * this._heightFactor;\n\n\t\tlet track  = this.track_info;\n\t\tlet eleMax = track.elevation_max || -Infinity;\n\t\tlet eleMin = track.elevation_min || +Infinity;\n\n\t\t// check and fix missing elevation data on last added point\n\t\tif (!this.options.skipNullZCoords && i > 0) {\n\t\t\tlet prevZ = data[i - 1].z;\n\t\t\tif (isNaN(prevZ)) {\n\t\t\t\tlet lastZ = this._lastValidZ;\n\t\t\t\tlet currZ = z;\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\n\t\t\t\t\tprevZ   = (lastZ + currZ) / 2;\n\t\t\t\t} else if (!isNaN(lastZ)) {\n\t\t\t\t\tprevZ   = lastZ;\n\t\t\t\t} else if (!isNaN(currZ)) {\n\t\t\t\t\tprevZ   = currZ;\n\t\t\t\t}\n\t\t\t\tif (!isNaN(prevZ)) return data.splice(i - 1, 1);\n\t\t\t\tdata[i - 1].z = prevZ;\n\t\t\t}\n\t\t}\n\t\t// skip point if it has not elevation\n\t\tif (!isNaN(z)) {\n\t\t\teleMax = eleMax < z ? z : eleMax;\n\t\t\teleMin = eleMin > z ? z : eleMin;\n\t\t\tthis._lastValidZ = z;\n\t\t}\n\n\t\tdata[i].z = z;\n\n\t\ttrack.elevation_max = eleMax;\n\t\ttrack.elevation_min = eleMin;\n\t});\n\n\tthis.on(\"elechart_axis\", function() {\n\n\t\tthis._chart._registerAxisGrid({\n\t\t\taxis      : \"y\",\n\t\t\tposition  : \"left\",\n\t\t\tscale     : this._chart._y,\n\t\t});\n\n\t});\n\n\tif (this.options.altitude != \"summary\") {\n\n\t\tthis.on(\"elechart_axis\", function() {\n\n\t\t\taltitude.y     = this._chart._y;\n\t\t\taltitude.label = this._yLabel;\n\n\t\t\tthis._chart._registerAxisScale({\n\t\t\t\taxis    : \"y\",\n\t\t\t\tposition: \"left\",\n\t\t\t\tscale   : altitude.y,\n\t\t\t\tlabel   : altitude.label,\n\t\t\t\tlabelX  : -3,\n\t\t\t\tlabelY  : -8,\n\t\t\t\tname    : \"altitude\",\n\t\t\t});\n\n\t\t});\n\n\t\tthis.on(\"elechart_init\", function() {\n\n\t\t\tlet theme      = this.options.theme.replace('-theme', '');\n\t\t\tlet color      = D3.Colors[theme] || {};\n\t\t\tlet alpha      = (this.options.detached ? (color.alpha || '0.8') : 1);\n\t\t\tlet stroke     = (this.options.detached ? color.stroke : false);\n\n\t\t\tthis._chart._registerAreaPath({\n\t\t\t\tname         : 'altitude',\n\t\t\t\tlabel        : 'Altitude',\n\t\t\t\tscaleX       : 'distance',\n\t\t\t\tscaleY       : 'altitude',\n\t\t\t\tcolor        : color.area || theme,\n\t\t\t\tstrokeColor  : stroke || '#000',\n\t\t\t\tstrokeOpacity: \"1\",\n\t\t\t\tfillOpacity  : alpha,\n\t\t\t\tpreferCanvas : this.options.preferCanvas,\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tthis._registerSummary({\n\t\t\"maxele\"  : {\n\t\t\tlabel: \"Max Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_max || 0).toFixed(2) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"minele\"  : {\n\t\t\tlabel: \"Min Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_min || 0).toFixed(2) + '&nbsp;' + this._yLabel\n\t\t},\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts = this.options;\n\tlet time = {};\n\n\ttime.label       = opts.timeLabel  || 't';\n\tthis._timeFactor = opts.timeFactor;\n\n\t/**\n\t * Common AVG speeds:\n\t * ----------------------\n\t *  slow walk = 1.8  km/h\n\t *  walking   = 3.6  km/h\n\t *  running   = 10.8 km/h\n\t *  cycling   = 18   km/h\n\t *  driving   = 72   km/h\n\t * ----------------------\n\t */\n\tthis._timeAVGSpeed = (opts.timeAVGSpeed || 3.6) * (opts.speedFactor || 1);\n\n\tif (!opts.timeFormat) {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleString().replaceAll('/', '-').replaceAll(',', ' ');\n\t} else if (opts.timeFormat == 'time') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleTimeString();\n\t} else if (opts.timeFormat == 'date') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleDateString();\n\t}\n\n\topts.xTimeFormat = opts.xTimeFormat || ((t) => _.formatTime(t).split(\"'\")[0]);\n\n\tif (opts.time && opts.time != \"summary\" && !L.Browser.mobile) {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"x\",\n\t\t\tposition   : \"top\",\n\t\t\tscale      : {\n\t\t\t\tattr       : \"duration\",\n\t\t\t\tmin        : 0,\n\t\t\t},\n\t\t\tlabel      : time.label,\n\t\t\tlabelY     : -10,\n\t\t\tlabelX     : () => this._width(),\n\t\t\tname       : \"time\",\n\t\t\ttickFormat : (d)  => (d == 0 ? '' : opts.xTimeFormat(d)),\n\t\t\tonAxisMount: axis => {\n\t\t\t\taxis.select(\".domain\")\n\t\t\t\t\t.remove();\n\t\t\t\taxis.selectAll(\"text\")\n\t\t\t\t\t.attr('opacity', 0.65)\n\t\t\t\t\t.style('font-family', 'Monospace')\n\t\t\t\t\t.style('font-size', '110%');\n\t\t\t\taxis.selectAll(\".tick line\")\n\t\t\t\t\t.attr('y2', this._height())\n\t\t\t\t\t.attr('stroke-dasharray', 2)\n\t\t\t\t\t.attr('opacity', 0.75);\n\t\t\t\t}\n\t\t});\n\n\t}\n\n\tthis.on('elepoint_added', function(e) {\n\t\tlet data = this._data;\n\t\tlet i    = e.index;\n\n\t\t// Add missing timestamps (see: options.timeAVGSpeed)\n\t\tif (!e.point.meta || !e.point.meta.time) {\n\t\t\te.point.meta = e.point.meta || {};\n\t\t\tlet delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist);\n\t\t\tlet speed = this._timeAVGSpeed;\n\t\t\te.point.meta.time = new Date(\n\t\t\t\t(\n\t\t\t\t\ti > 0\n\t\t\t\t\t\t? data[i - 1].time.getTime() + ((( delta / speed) * this._timeFactor) * 1000)\n\t\t\t\t\t\t: Date.now()\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tlet time = e.point.meta.time;\n\n\t\t// Handle timezone offset\n\t\tif (time.getTime() - time.getTimezoneOffset() * 60 * 1000 === 0) {\n\t\t\ttime = 0;\n\t\t}\n\n\t\tlet currT    = time;\n\t\tlet prevT    = i > 0 ? data[i - 1].time : currT;\n\n\t\tlet deltaT   = Math.abs(currT - prevT);\n\t\tlet duration = (this.track_info.time || 0) + deltaT;\n\n\t\tdata[i].time         = time;\n\t\tdata[i].duration     = duration;\n\n\t\tthis.track_info.time = duration;\n\t});\n\n\tif (this.options.time) {\n\n\t\tthis._registerFocusLabel({\n\t\t\tname: 'time',\n\t\t\tchart: (item) => this.options.timeFormat(item.time)\n\t\t});\n\n\t\tthis._registerSummary({\n\t\t\t\"tottime\"  : {\n\t\t\t\tlabel: \"Total Time: \",\n\t\t\t\tvalue: (track) => _.formatTime(track.time || 0)\n\t\t\t}\n\t\t});\n\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.slope) return;\n\n\tlet opts  = this.options;\n\tlet slope = {};\n\n\tslope.label          = opts.slopeLabel || '%';\n\n\tif (this.options.slope != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : -1,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : slope.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : 'slope'\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname         : 'slope',\n\t\t\tlabel        : 'Slope',\n\t\t\tyAttr        : 'slope',\n\t\t\tscaleX       : 'distance',\n\t\t\tscaleY       : 'slope',\n\t\t\tcolor        : '#F00',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data  = this._data;\n\t\tlet i     = e.index;\n\t\tlet z     = data[i].z;\n\t\tlet delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n\n\t\t// Slope / Gain\n\t\tlet track = this.track_info;\n\t\tlet tAsc  = track.ascent    || 0; // Total Ascent\n\t\tlet tDes  = track.descent   || 0; // Total Descent\n\t\tlet sMax  = track.slope_max || 0; // Slope Max\n\t\tlet sMin  = track.slope_min || 0; // Slope Min\n\t\tlet slope = 0;\n\n\t\tif (!isNaN(z)) {\n\t\t\tlet deltaZ  = i > 0 ? z - data[i - 1].z : 0;\n\t\t\tif (deltaZ > 0)      tAsc += deltaZ;\n\t\t\telse if (deltaZ < 0) tDes -= deltaZ;\n\t\t\t// slope in % = ( height / length ) * 100\n\t\t\tif (delta !== 0)     slope = (deltaZ / delta) * 100;\n\t\t}\n\n\t\t// Try to smooth \"crazy\" slope values.\n\t\tif (this.options.sDeltaMax) {\n\t\t\tlet deltaS    = i > 0 ? slope - data[i - 1].slope : 0;\n\t\t\tlet maxDeltaS = this.options.sDeltaMax;\n\t\t\tif (Math.abs(deltaS) > maxDeltaS) {\n\t\t\t\tslope       = data[i - 1].slope + maxDeltaS * Math.sign(deltaS);\n\t\t\t}\n\t\t}\n\n\t\t// Range of acceptable slope values.\n\t\tif (this.options.sRange) {\n\t\t\tlet range = this.options.sRange;\n\t\t\tif (slope < range[0])      slope = range[0];\n\t\t\telse if (slope > range[1]) slope = range[1];\n\t\t}\n\n\t\tslope = L.Util.formatNum(slope, 2);\n\n\t\tif (slope > sMax) sMax = slope;\n\t\tif (slope < sMin) sMin = slope;\n\n\t\tdata[i].slope   = slope;\n\n\t\ttrack.ascent    = tAsc;\n\t\ttrack.descent   = tDes;\n\t\ttrack.slope_max = sMax;\n\t\ttrack.slope_min = sMin;\n\t});\n\n\tthis._registerFocusLabel({\n\t\tname: 'slope',\n\t\tchart: (item) => item.slope + slope.label,\n\t\tmarker: (item) => Math.round(item.slope) + slope.label\n\t});\n\n\tthis._registerSummary({\n\t\t\"ascent\"  : {\n\t\t\tlabel: \"Total Ascent: \",\n\t\t\tvalue: (track) => Math.round(track.ascent || 0) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"descent\"  : {\n\t\t\tlabel: \"Total Descent: \",\n\t\t\tvalue: (track) => Math.round(track.descent || 0) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"minslope\": {\n\t\t\tlabel: \"Min Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_min || 0) + '&nbsp;' + slope.label\n\t\t},\n\t\t\"maxslope\": {\n\t\t\tlabel: \"Max Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_max || 0) + '&nbsp;' + slope.label\n\t\t}\n\t});\n\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.speed && !this.options.acceleration) return;\n\n\tlet opts = this.options;\n\tlet speed = {};\n\n\tspeed.label          = opts.speedLabel  || L._(this.options.imperial ? 'mph' : 'km/h');\n\tthis._speedFactor    = opts.speedFactor || 1;\n\n\tif (this.options.speed && this.options.speed != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : 0,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : speed.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : \"speed\"\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname       : 'speed',\n\t\t\tlabel      : 'Speed',\n\t\t\tyAttr      : \"speed\",\n\t\t\tscaleX     : 'distance',\n\t\t\tscaleY     : 'speed',\n\t\t\tcolor      : '#03ffff',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis.on('elepoint_added', function(e) {\n\t\tlet data   = this._data;\n\t\tlet i      = e.index;\n\n\t\tlet currT  = data[i].time;\n\t\tlet prevT  = i > 0 ? data[i - 1].time : currT;\n\n\t\tlet deltaT = currT - prevT;\n\n\t\tlet track  = this.track_info;\n\t\tlet sMax   = track.speed_max || -Infinity; // Speed Max\n\t\tlet sMin   = track.speed_min || +Infinity; // Speed Min\n\t\tlet sAvg   = track.speed_avg || 0;         // Speed Avg\n\t\tlet speed  = 0;\n\n\t\tif (deltaT > 0) {\n\t\t\tlet delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n\t\t\tspeed = Math.abs((delta / deltaT) * this._timeFactor) * this._speedFactor;\n\t\t}\n\n\t\t// Try to smooth \"crazy\" speed values.\n\t\tif (this.options.speedDeltaMax) {\n\t\t\tlet deltaS    = i > 0 ? speed - data[i - 1].speed : 0;\n\t\t\tlet maxDeltaS = this.options.speedDeltaMax;\n\t\t\tif (Math.abs(deltaS) > maxDeltaS) {\n\t\t\t\tspeed       = data[i - 1].speed + maxDeltaS * Math.sign(deltaS);\n\t\t\t}\n\t\t}\n\n\t\t// Range of acceptable speed values.\n\t\tif (this.options.speedRange) {\n\t\t\tlet range = this.options.speedRange;\n\t\t\tif (speed < range[0])      speed = range[0];\n\t\t\telse if (speed > range[1]) speed = range[1];\n\t\t}\n\n\t\tspeed = L.Util.formatNum(speed, 2);\n\n\t\tsMax = speed > sMax ? speed : sMax;\n\t\tsMin = speed < sMin ? speed : sMin;\n\t\tsAvg = (speed + sAvg) / 2.0;\n\n\t\tdata[i].speed = speed;\n\n\t\ttrack.speed_max = sMax;\n\t\ttrack.speed_min = sMin;\n\t\ttrack.speed_avg = sAvg;\n\t});\n\n\tif (this.options.speed) {\n\n\t\tthis._registerFocusLabel({\n\t\t\tname: 'speed',\n\t\t\tchart: (item) => item.speed + \" \" + speed.label,\n\t\t\tmarker: (item) => Math.round(item.speed) + \" \" + speed.label\n\t\t});\n\n\t\tthis._registerSummary({\n\t\t\t\"minspeed\"  : {\n\t\t\t\tlabel: \"Min Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_min || 0) + '&nbsp;' + speed.label\n\t\t\t},\n\t\t\t\"maxspeed\"  : {\n\t\t\t\tlabel: \"Max Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_max || 0) + '&nbsp;' + speed.label\n\t\t\t},\n\t\t\t\"avgspeed\": {\n\t\t\t\tlabel: \"Avg Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_avg || 0) + '&nbsp;' + speed.label\n\t\t\t}\n\t\t});\n\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.acceleration) return;\n\n\tlet opts = this.options;\n\tlet acceleration = {};\n\n\tacceleration.label       = opts.accelerationLabel  || L._(this.options.imperial ? 'ft/s²' : 'm/s²');\n\tthis._accelerationFactor = opts.accelerationFactor || 1;\n\n\tif (this.options.acceleration != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : 0,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : acceleration.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : 'acceleration'\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname       : 'acceleration',\n\t\t\tlabel      : 'Acceleration',\n\t\t\tyAttr      : 'acceleration',\n\t\t\tscaleX     : 'distance',\n\t\t\tscaleY     : 'acceleration',\n\t\t\tcolor      : '#050402',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis.on('elepoint_added', function(e) {\n\t\tlet data   = this._data;\n\t\tlet i      = e.index;\n\n\t\tlet currT  = data[i].time;\n\t\tlet prevT  = i > 0 ? data[i - 1].time : currT;\n\n\t\tlet deltaT = (currT - prevT) / 1000;\n\n\t\tlet track  = this.track_info;\n\t\tlet sMax   = track.acceleration_max || -Infinity; // Acceleration Max\n\t\tlet sMin   = track.acceleration_min || +Infinity; // Acceleration Min\n\t\tlet sAvg   = track.acceleration_avg || 0; // Acceleration Avg\n\t\tlet acceleration = 0;\n\n\t\tif (deltaT > 0) {\n\t\t\tlet curr     = data[i].speed;\n\t\t\tlet prev     = i > 0 ? data[i - 1].speed : curr;\n\t\t\tlet delta    = (curr - prev) * (1000 / this._timeFactor);\n\t\t\tacceleration = Math.abs((delta / deltaT)) * this._accelerationFactor;\n\t\t}\n\n\t\t// Try to smooth \"crazy\" acceleration values.\n\t\tif (this.options.accelerationDeltaMax) {\n\t\t\tlet deltaA     = i > 0 ? acceleration - data[i - 1].acceleration : 0;\n\t\t\tlet maxDeltaS  = this.options.accelerationDeltaMax;\n\t\t\tif (Math.abs(deltaA) > maxDeltaS) {\n\t\t\t\tacceleration = data[i - 1].acceleration + maxDeltaS * Math.sign(deltaA);\n\t\t\t}\n\t\t}\n\n\t\t// Range of acceptable acceleration values.\n\t\tif (this.options.accelerationRange) {\n\t\t\tlet range = this.options.accelerationRange;\n\t\t\tif (acceleration < range[0])      acceleration = range[0];\n\t\t\telse if (acceleration > range[1]) acceleration = range[1];\n\t\t}\n\n\t\tacceleration = L.Util.formatNum(acceleration, 2);\n\n\t\tif (acceleration > sMax) sMax = acceleration;\n\t\tif (acceleration < sMin) sMin = acceleration;\n\t\tsAvg = (acceleration + sAvg) / 2.0;\n\n\t\tdata[i].acceleration = acceleration;\n\n\t\ttrack.acceleration_max = sMax;\n\t\ttrack.acceleration_min = sMin;\n\t\ttrack.acceleration_avg = sAvg;\n\t});\n\n\tthis._registerFocusLabel({\n\t\tname  : 'acceleration',\n\t\tchart : (item) => item.acceleration + \" \" + acceleration.label,\n\t\tmarker: (item) => Math.round(item.acceleration) + \" \" + acceleration.label,\n\t});\n\n\tthis._registerSummary({\n\t\t\"minacceleration\"  : {\n\t\t\tlabel: \"Min Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_min || 0) + '&nbsp;' + acceleration.label\n\t\t},\n\t\t\"maxacceleration\"  : {\n\t\t\tlabel: \"Max Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_max || 0) + '&nbsp;' + acceleration.label\n\t\t},\n\t\t\"avgacceleration\": {\n\t\t\tlabel: \"Avg Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_avg || 0) + '&nbsp;' + acceleration.label\n\t\t}\n\t});\n\n});\n","/*\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\n *\n *  This file is free software: you may copy, redistribute and/or modify it\n *  under the terms of the GNU General Public License as published by the\n *  Free Software Foundation, either version 2 of the License, or (at your\n *  option) any later version.\n *\n *  This file is distributed in the hope that it will be useful, but\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see .\n *\n * This file incorporates work covered by the following copyright and\n * permission notice:\n *\n *     Copyright (c) 2013-2016, MIT License, Felix “MrMufflon” Bache\n *\n *     Permission to use, copy, modify, and/or distribute this software\n *     for any purpose with or without fee is hereby granted, provided\n *     that the above copyright notice and this permission notice appear\n *     in all copies.\n *\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Elevation } from './control';\nimport './distance';\nimport './altitude';\nimport './time';\nimport './slope';\nimport './speed';\nimport './acceleration';\n\nElevation.Utils = _;\nElevation.Components = D3;\nElevation.Chart = Chart;\n\nL.control.elevation = (options) => new Elevation(options);\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","addEventListener","once","debounce","func","wait","context","immediate","timeout","args","arguments","clearTimeout","setTimeout","apply","SEC","MIN","HOUR","DAY","formatTime","t","d","Math","floor","h","m","s","round","toString","padStart","GeoJSONLoader","control","JSON","parse","distanceMarkers","options","lazy","layer","geoJson","style","feature","polyline","theme","className","pointToLayer","latlng","marker","icon","gpxOptions","marker_options","wptIcons","prop","properties","desc","name","bindPopup","openPopup","_registerCheckPoint","label","fire","point","point_type","element","onEachFeature","geometry","type","_latlngs","forEach","i","meta","time","ele","hr","cad","atemp","alt","Date","coordTimes","times","parseInt","heartRates","heartRate","addData","on","e","path","DistanceMarkers","Polyline","track_info","Control","Elevation","_d3LazyLoader","then","_fireEvt","isDomVisible","elem","offsetWidth","offsetHeight","getClientRects","item","Array","isArray","isVisible","styles","getComputedStyle","isVisibleByStyles","visibility","display","isAboveOtherElements","boundingRect","getBoundingClientRect","left","right","top","bottom","above","pointerEvents","elementFromPoint","isJSONDoc","doc","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","split","every","DomUtil","removeClass","toggleClass","conditional","call","replaceClass","removeClassName","addClassName","value","getStyle","setProperty","toggleStyle","toggleEvent","leafletElement","eventName","handler","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","querySelector","DomEvent","off","hasClass","randomId","random","substr","each","obj","fn","Colors","area","alpha","stroke","line","Area","width","height","xAttr","yAttr","scaleX","scaleY","interpolation","d3","curve","x","xDiagCoord","y0","y1","Path","color","strokeColor","strokeOpacity","fillOpacity","classed","attr","Axis","tickSize","tickPadding","axis","scale","ticks","tickFormat","labelX","labelY","onAxisMount","g","w","axisScale","replace","l","toUpperCase","axisGroup","join","text","Grid","props","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusMarker","circle","LegendItem","margins","toLowerCase","svg","ownerSVGElement","dispatch","detail","legend","enabled","MouseFocusLine","MouseFocusLabel","rect","xAlign","yAlign","bbox","getBBox","max","Browser","webkit","Infinity","Ruler","symbol","symbolTriangle","exit","remove","enter","merge","size","angle","Domain","min","forceBounds","domain","extent","Range","Scale","range","scaleLinear","Bisect","bisector","invert","Chart","ruler","_width","_height","panes","grid","brush","tooltip","clipPath","clipRect","foreignObject","canvas","getContext","dragG","focusG","brushG","brushX","opts","utils","chart","_resize","pane","get","Class","includes","Evented","prototype","Mixin","Events","initialize","_data","_props","scales","paths","areas","grids","axes","legendItems","focusLabels","_scales","_domains","_ranges","_paths","_brushEnabled","dragging","_zoomEnabled","zooming","imperial","_xLabel","_yLabel","xLabel","yLabel","_chart","D3","_container","_grid","_area","_point","_axis","_legend","_initScale","_clipPath","_canvas","_context","_dragG","_focusG","_brush","_focusline","_focuslabel","_zoom","zoom","_drag","drag","_initInteractions","update","_updateScale","_updateArea","_updateAxis","_updateLegend","_updateClipper","render","container","clear","_resetDrag","clearRect","_path","_drawPath","ctx","datum","preferCanvas","beginPath","moveTo","p","Path2D","strokeStyle","fillStyle","lineWidth","globalCompositeOperation","globalAlpha","fill","closePath","_hasActiveLayers","_initBrush","selection","start","_findIndexForXCoord","end","dragstart","dragend","focus","sourceEvent","coords","pointers","filter","shiftKey","button","bind","_initClipper","margin","onStart","transform","onEnd","onZoom","distance","_x","rescaleX","_hideDiagramIndicator","scaleExtent","translateExtent","buttons","_initRuler","_initLegend","formatNum","format","yMax","z","_y","_findCoordsForY","_registerAxisScale","xAxisMin","xAxisMax","yAxisMin","yAxisMax","altitude","_registerAreaPath","_registerAxisGrid","forceAxisBounds","xTicks","yTicks","_findIndexForLatLng","dist","isNaN","property","pos","y2","x2","_registerFocusLabel","gridOpts","axesOpts","n","substring","legends","items","nodes","v","map","sign","rev","slice","reverse","push","concat","xAxesB","marginB","marginR","tx","ty","r","list","reduce","array","index","next","curr","result","distanceTo","_resetZoom","zoomIdentity","_showDiagramIndicator","xCoordinate","yCoordinate","decimalsX","decimalsY","labels","Marker","_focusmarker","_marker","markerIcon","zIndexOffset","interactive","_focuslabels","addTo","_map","getPane","_latlng","latLngToLayerPoint","_rotate","rotatedPointToMapPanePoint","normalizedAlt","maxElevation","normalizedY","getElement","setLatLng","getLatLng","Summary","summary","reset","innerHTML","_registerSummary","Options","autofitBounds","autohide","mobile","autohideMarker","almostover","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","divIcon","html","iconSize","iconAnchor","heightFactor","lazyLoadJS","loadData","defer","placeholder","opacity","weight","lineCap","polylineSegments","reverseCoords","skipNullZCoords","responsive","slope","speed","sLimit","undefined","timeFactor","timeFormat","sDeltaMax","sInterpolation","sRange","zFollow","Mobile","__mileFactor","__footFactor","__D3","__TOGEOJSON","__LGEOMUTIL","__LALMOSTOVER","__LDISTANCEM","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","getContainer","onAdd","_layers","clearLayers","disableBrush","enableBrush","enableDragging","enableBrushing","disableDragging","disableBrushing","disableZoom","enableZoom","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","featureGroup","_markedSegments","_chartEnabled","_setMapView","throttle","setStyle","colors","load","loadChart","loadDefer","loadLazy","loadXML","loadGeoJSON","loadFile","fetch","response","_downloadURL","catch","loadGPX","_togeojsonLazyLoader","toGeoJSON","xml","DOMParser","parseFromString","geojson","getElementsByTagName","pop","parentNode","_initButton","_initChart","_initSummary","_initMarker","_initLayer","_hideMarker","_resetView","_resizeChart","_rotateMarker","_updateChart","_updateSummary","onRemove","redraw","setZFollow","show","geom","_addGeoJSONData","coordinates","features","_addGPXData","_addPoint","lat","lng","latLng","addLayer","id","_collapse","_expand","_findItemForLatLng","_findItemForX","propagate","_xTicks","_yTicks","clientWidth","_maxWidth","maxWidth","_dragendHandler","_mousemoveHandler","_mouseoutHandler","_rulerFilterHandler","_toggleChartHandler","_mousemoveLayerHandler","_pane","createPane","zIndex","_renderer","disableClickPropagation","stopPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_summary","summaryDiv","_updateMarker","gestureHandling","_enabled","ll","getCenter","getZoom","deltaY","flyTo","_isFullscreen","newWidth","_updateMapSegments","setView","animate","duration","contains","eachLayer","elevation_max","setLatLngs","hasLayer","onclick","preventDefault","confirm","__xTicks","__yTicks","addInitHook","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","CustomEvent","dispatchEvent","_geomutilLazyLoader","GeometryUtil","almostOver","_almostoverLazyLoader","Handler","AlmostOver","addHandler","_distanceMarkersLazyLoader","oldProto","Canvas","_fillStroke","include","oldVal","_distanceFactor","track","prev","delta","toFixed","_heightFactor","eleMax","eleMin","elevation_min","prevZ","lastZ","_lastValidZ","currZ","splice","timeLabel","_timeFactor","_timeAVGSpeed","timeAVGSpeed","speedFactor","toLocaleString","replaceAll","toLocaleTimeString","toLocaleDateString","xTimeFormat","getTime","now","getTimezoneOffset","currT","prevT","deltaT","abs","slopeLabel","tAsc","ascent","tDes","descent","sMax","slope_max","sMin","slope_min","deltaZ","deltaS","maxDeltaS","acceleration","speedLabel","_speedFactor","speed_max","speed_min","sAvg","speed_avg","speedDeltaMax","speedRange","accelerationLabel","_accelerationFactor","accelerationFactor","acceleration_max","acceleration_min","acceleration_avg","accelerationDeltaMax","deltaA","accelerationRange","Utils","Components","elevation"],"mappings":"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"}